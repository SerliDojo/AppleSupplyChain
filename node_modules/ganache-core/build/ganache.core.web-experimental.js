!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Ganache",[],e):"object"==typeof exports?exports.Ganache=e():t.Ganache=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=59)}([function(t,e,n){var r=n(1);t.exports={hex:function(t){if("string"==typeof t){if(0===t.indexOf("0x"))return t.trim();t=new r.BN(t)}return"boolean"==typeof t&&(t=t?1:0),"number"==typeof t&&(t=r.intToHex(t)),"object"==typeof t&&(t=t.toString("hex")),r.addHexPrefix(t)},rpcQuantityHexString:function(t){return"0x"===(t="0x"+(t=this.hex(t)).replace("0x","").replace(/^0+/,""))&&(t="0x0"),t},rpcDataHexString:function(t,e){if("number"==typeof e)t=this.hex(t).replace("0x",""),t=new Array(e-t.length).fill("0").join("")+t;else{if(0===t.length)return"0x";(t=this.hex(t).replace("0x","")).length%2!=0&&(t="0"+t)}return"0x"+t},nullableRpcDataHexString:function(t,e){const n=this.rpcDataHexString(t,e);return"0x"===n?null:n},hexWithZeroPadding:function(t){const e=(t=this.hex(t)).replace("0x","");return 1&e.length?"0x0"+e:t},number:function(t){if("number"==typeof t)return t;if("string"==typeof t&&0!==t.indexOf("0x"))return parseInt(t,10);var e=r.toBuffer(t);return r.bufferToInt(e)}}},function(t,e){t.exports=require("ethereumjs-util")},function(t,e){t.exports=require("util")},function(t,e){t.exports=require("async")},function(t,e){t.exports=require("source-map-support/register")},function(t,e){t.exports=require("web3-provider-engine/subproviders/subprovider.js")},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(71),o=n(72),i=n(73);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),o=(t=a(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?a(t,0):f(t,e);if("Buffer"===e.type&&i(e.data))return f(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(l(e),t=a(t,e<0?0:0|p(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,o);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,o){var i,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var l=-1;for(i=n;i<a;i++)if(u(t,i)===u(e,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var h=!0,f=0;f<c;f++)if(u(t,i+f)!==u(e,f)){h=!1;break}if(h)return i}return-1}function y(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function v(t,e,n,r){return z(U(e,t.length-n),t,n,r)}function k(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return k(t,e,n,r)}function _(t,e,n,r){return z(F(e),t,n,r)}function w(t,e,n,r){return z(function(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function B(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function T(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,s,a,c,u=t[o],l=null,h=u>239?4:u>223?3:u>191?2:1;if(o+h<=n)switch(h){case 1:u<128&&(l=u);break;case 2:128==(192&(i=t[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=h}return function(t){var e=t.length;if(e<=S)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=S));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return h(null,t)},c.allocUnsafeSlow=function(t){return h(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return E(this,e,n);case"base64":return B(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,o){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var i=o-r,s=n-e,a=Math.min(i,s),u=this.slice(r,o),l=t.slice(e,n),h=0;h<a;++h)if(u[h]!==l[h]){i=u[h],s=l[h];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return v(this,t,e,n);case"ascii":return k(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return _(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function A(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function E(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function P(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=j(t[i]);return o}function C(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,n,r,o,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function H(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function O(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function L(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function q(t,e,n,r,i){return i||L(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function D(t,e,n,r,i){return i||L(t,0,n,8),o.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var o=e-t;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},c.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),o.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),o.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),o.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),o.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||N(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||N(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):H(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):H(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):O(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);N(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);N(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):H(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):H(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):O(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return q(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return q(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return D(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return D(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=c.isBuffer(t)?t:U(new c(t,r).toString()),a=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%a]}return this};var I=/[^+\/0-9A-Za-z-_]/g;function j(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function F(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(I,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(13))},function(t,e){t.exports=require("lodash")},function(t,e){t.exports=require("ethereumjs-account")},function(t,e){t.exports=require("ethereumjs-tx/fake.js")},function(t,e){t.exports=require("ethereumjs-block")},function(t,e){t.exports=require("events")},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(65),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(13))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(2).inherits,o=n(0),i=n(26);function s(t,e){Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.results={},this.hashes=[],this.combine(t,e)}r(s,Error),s.prototype.combine=function(t,e){if(t instanceof s)for(var n=t,r=Object.keys(n.results),a=0;a<r.length;a++){var c=r[a];this.results[c]=n.results[c],Array.prototype.push.apply(this.hashes,n.hashes)}else{var u=e.results;for(a=0;a<t.length;a++){var l=t[a],h=u[a];if(1!==h.vm.exception){var f,p=o.hex(l.hash());this.hashes.push(p);var d=h.vm.return;d&&"08c379a0"===d.slice(0,4).toString("hex")&&(f=i.rawDecode(["string"],d.slice(4))[0]),this.results[p]={error:h.vm.exceptionError.error||h.vm.exceptionError,program_counter:h.vm.runState.programCounter,return:o.hex(h.vm.return),reason:f}}}}if(1===this.hashes.length){var g=this.results[this.hashes[0]],m="VM Exception while processing transaction: "+g.error;g.reason&&(m+=" "+g.reason),this.message=m}else{for(m="Multiple VM Exceptions while processing transactions: \n\n",a=0;a<this.hashes.length;a++)m+=(p=this.hashes[a])+": "+(g=this.results[p]).error,g.reason&&(m+=" "+g.reason),m+="\n";this.message=m}},s.prototype.count=function(){return Object.keys(this.results).length},s.fromResults=function(t,e){var n=new s(t,e);return 0===n.count()?null:n},t.exports=s},function(t,e,n){var r=n(0);function o(t){var e=this;Object.keys(t).forEach(function(n){e[n]=t[n]})}o.prototype.toJSON=function(){return{logIndex:r.rpcQuantityHexString(this.logIndex),transactionIndex:r.rpcQuantityHexString(this.transactionIndex),transactionHash:r.rpcDataHexString(this.transactionHash),blockHash:r.rpcDataHexString(this.block.hash()),blockNumber:r.rpcQuantityHexString(this.block.header.number),address:r.rpcDataHexString(this.address),data:r.rpcDataHexString(this.data),topics:this.topics,type:"mined"}},t.exports=o},function(t,e,n){var r=n(0);function o(t,e,n,r,o,i,s,a){this.tx=t,this.block=e,this.logs=n,this.gasUsed=r,this.cumulativeGasUsed=o,this.contractAddress=i,this.status=s,this.logsBloom=a,this.transactionIndex=0;for(var c=0;c<e.transactions.length;c++){if(e.transactions[c].hash().equals(t.hash())){this.transactionIndex=c;break}}}o.prototype.toJSON=function(){return{transactionHash:r.rpcDataHexString(this.tx.hash()),transactionIndex:r.rpcQuantityHexString(this.transactionIndex),blockHash:r.rpcDataHexString(this.block.hash()),blockNumber:r.rpcQuantityHexString(this.block.header.number),gasUsed:r.rpcQuantityHexString(this.gasUsed),cumulativeGasUsed:r.rpcQuantityHexString(this.cumulativeGasUsed),contractAddress:null!=this.contractAddress?r.rpcDataHexString(this.contractAddress):null,logs:this.logs.map(function(t){return t.toJSON()}),status:r.rpcQuantityHexString(this.status),logsBloom:r.rpcDataHexString(this.logsBloom),v:r.rpcDataHexString(this.tx.v),r:r.rpcDataHexString(this.tx.r),s:r.rpcDataHexString(this.tx.s)}},t.exports=o},function(t,e){t.exports=require("merkle-patricia-tree")},function(t,e){t.exports=require("level-sublevel")},function(t,e,n){"use strict";var r=n(22).version,o=n(47),i=n(48),s=n(49),a=n(50),c=n(51),u=n(52),l=n(53),h=function(){var t=this;o.packageInit(this,arguments),this.version=r,this.utils=l,this.eth=new i(this),this.shh=new c(this),this.bzz=new u(this);var e=this.setProvider;this.setProvider=function(n,r){return e.apply(t,arguments),this.eth.setProvider(n,r),this.shh.setProvider(n,r),this.bzz.setProvider(n),!0}};h.version=r,h.utils=l,h.modules={Eth:i,Net:s,Personal:a,Shh:c,Bzz:u},o.addProviders(h),t.exports=h},function(t,e,n){var r=n(0),o=n(9),i=n(1);t.exports={toJSON:function(t,e){for(var n=0,o=0;o<e.transactions.length;o++){if(e.transactions[o].hash().equals(t.hash())){n=o;break}}var i={hash:r.nullableRpcDataHexString(t.hash()),nonce:r.rpcQuantityHexString(t.nonce),blockHash:r.nullableRpcDataHexString(e.hash()),blockNumber:r.rpcQuantityHexString(e.header.number),transactionIndex:r.rpcQuantityHexString(n),from:r.nullableRpcDataHexString(t.from),to:r.nullableRpcDataHexString(t.to),value:r.rpcQuantityHexString(t.value),gas:r.rpcQuantityHexString(t.gasLimit),gasPrice:r.rpcQuantityHexString(t.gasPrice),input:r.nullableRpcDataHexString(t.data)};return t.v&&t.v.length>0&&t.r&&t.r.length>0&&t.s&&t.s.length>0&&(i.v=r.hex(t.v),i.r=r.hex(t.r),i.s=r.hex(t.s)),i},fromJSON:function(t){var e=new o({nonce:i.toBuffer(r.hex(t.nonce)),from:i.toBuffer(r.hex(t.from)),value:i.toBuffer(r.hex(t.value)),gasLimit:i.toBuffer(r.hex(t.gas)),gasPrice:i.toBuffer(r.hex(t.gasPrice)),data:i.toBuffer(r.hex(t.input))});if(t.v&&t.v.length>0&&t.r&&t.r.length>0&&t.s&&t.s.length>0&&(e.v=i.toBuffer(r.hex(t.v)),e.r=i.toBuffer(r.hex(t.r)),e.s=i.toBuffer(r.hex(t.s))),t.to){var n=i.toBuffer(r.hex(t.to));n.equals(i.toBuffer("0x0"))||(e.to=i.setLengthLeft(n,20))}return e}}},function(t){t.exports={name:"ganache-core",version:"2.2.1",main:"./index.js",engines:{node:">=8.9.0"},directories:{lib:"./lib"},prettier:{printWidth:120,arrowParens:"always"},scripts:{_mocha:"mocha --check-leaks --recursive --globals _scratch,sanitizedData",_lint:"eslint --ignore-path .gitignore .",build:"webpack-cli --config ./webpack/node/core.webpack.config.js","build-web":"webpack-cli --config ./webpack/web-experimental/core.webpack.config.js",format:'prettier --write "{lib,perf,test}/**/*.js" && eslint --fix --ignore-path .gitignore .',prepublishOnly:"npm run test && npm run build && npm run test-build",test:"npm run _lint && npm run _mocha","test-build":"cross-env TEST_BUILD=node npm run _mocha","test-web-experimental":"cross-env TEST_BUILD=web-experimental npm run _mocha"},dependencies:{"abstract-leveldown":"3.0.0",async:"2.6.1",bip39:"2.5.0","bn.js":"4.11.8",cachedown:"1.0.0",clone:"2.1.2",debug:"3.1.0","encoding-down":"5.0.4","eth-sig-util":"2.0.2","ethereumjs-abi":"0.6.5","ethereumjs-account":"2.0.5","ethereumjs-block":"1.2.2","ethereumjs-tx":"1.3.4","ethereumjs-util":"5.2.0","ethereumjs-vm":"2.4.0",heap:"0.2.6","intercept-require":"^1.1.0","level-sublevel":"6.6.4",levelup:"3.1.1",lodash:"4.17.10","merkle-patricia-tree":"2.3.1",seedrandom:"2.4.4",tmp:"0.0.33","web3-provider-engine":"^14.0.6",websocket:"1.0.26"},devDependencies:{"assert-match":"^1.1.1",eslint:"5.7.0","eslint-config-standard":"12.0.0","eslint-plugin-import":"2.14.0","eslint-plugin-node":"7.0.1","eslint-plugin-promise":"4.0.1","eslint-plugin-standard":"4.0.0",memdown:"^1.3.1",mocha:"5.2.0",prettier:"^1.14.3",browserfs:"1.4.3","cross-env":"5.2.0","ethereumjs-wallet":"0.6.2",pify:"4.0.0",portfinder:"^1.0.18",request:"^2.88.0",solc:"0.4.24","source-map-support":"^0.5.9",temp:"0.8.3",web3:"1.0.0-beta.35",webpack:"4.17.1","webpack-bundle-size-analyzer":"2.7.0","webpack-cli":"3.1.0"},optionalDependencies:{"ethereumjs-wallet":"0.6.2",web3:"1.0.0-beta.35"},repository:{type:"git",url:"https://github.com/trufflesuite/ganache-core"},license:"MIT"}},function(t){t.exports={_args:[["web3@1.0.0-beta.35","C:\\Users\\David\\Desktop\\Code\\ganache-core"]],_development:!0,_from:"web3@1.0.0-beta.35",_id:"web3@1.0.0-beta.35",_inBundle:!1,_integrity:"sha512-xwDmUhvTcHQvvNnOPcPZZgCxKUsI2e+GbHy7JkTK3/Rmnutazy8x7fsAXT9myw7V1qpi3GgLoZ3fkglSUbg1Mg==",_location:"/web3",_optional:!0,_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"web3@1.0.0-beta.35",name:"web3",escapedName:"web3",rawSpec:"1.0.0-beta.35",saveSpec:null,fetchSpec:"1.0.0-beta.35"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/web3/-/web3-1.0.0-beta.35.tgz",_spec:"1.0.0-beta.35",_where:"C:\\Users\\David\\Desktop\\Code\\ganache-core",author:{name:"ethereum.org"},authors:[{name:"Fabian Vogelsteller",email:"fabian@ethereum.org",homepage:"http://frozeman.de"},{name:"Marek Kotewicz",email:"marek@parity.io",url:"https://github.com/debris"},{name:"Marian Oancea",url:"https://github.com/cubedro"},{name:"Gav Wood",email:"g@parity.io",homepage:"http://gavwood.com"},{name:"Jeffery Wilcke",email:"jeffrey.wilcke@ethereum.org",url:"https://github.com/obscuren"}],bugs:{url:"https://github.com/ethereum/web3.js/issues"},dependencies:{"web3-bzz":"1.0.0-beta.35","web3-core":"1.0.0-beta.35","web3-eth":"1.0.0-beta.35","web3-eth-personal":"1.0.0-beta.35","web3-net":"1.0.0-beta.35","web3-shh":"1.0.0-beta.35","web3-utils":"1.0.0-beta.35"},description:"Ethereum JavaScript API",keywords:["Ethereum","JavaScript","API"],license:"LGPL-3.0",main:"src/index.js",name:"web3",namespace:"ethereum",repository:{type:"git",url:"https://github.com/ethereum/web3.js/tree/master/packages/web3"},types:"index.d.ts",version:"1.0.0-beta.35"}},function(t,e,n){(function(e){n(4);let r=n(24),o=n(25),i=n(66),s=n(67),a=n(68),c=n(69),u=n(87),l=n(14),h=n(11),f=n(7);function p(t){const e=this;h.call(this),this.options=t=e._applyDefaultOptions(t||{});let n=new c(t,this);this.engine=new r({blockTracker:new u({blockchain:n.state.blockchain})});let l=new o;this.engine.manager=n,this.engine.addProvider(new i),this.engine.addProvider(new s),this.engine.addProvider(l),this.engine.addProvider(new a),this.engine.addProvider(n),this.engine.setMaxListeners(100),this.engine.start(),this.manager=n,this.sendAsync=this.send.bind(this),this.send=this.send.bind(this),this.close=this.close.bind(this),this._queueRequest=this._queueRequest.bind(this),this._processRequestQueue=this._processRequestQueue.bind(this),l.on("data",function(t,n){e.emit("data",t,n)})}const d={vmErrorsOnRPCResponse:!0,verbose:!1,asyncRequestProcessing:!1,logger:{log:function(){}}};p.prototype=Object.create(h.prototype),p.prototype.constructor=p,p.prototype._applyDefaultOptions=function(t){return f.merge({},d,t)},p.prototype.send=function(t,e){if("function"!=typeof e)throw new Error("No callback provided to provider's send function. As of web3 1.0, provider.send is no longer synchronous and must be passed a callback as its final argument.");let n=this,r=function(t){return f.cloneDeep(t)};t=Array.isArray(t)?t.map(r):r(t);let o=function(r,o){let i;if(o=f.cloneDeep(o),Array.isArray(o)){i=[];for(let e=0;e<o.length;e++)i.push(n.reportErrorInResponse(t[e],r,o[e]))}else i=n.reportErrorInResponse(t,r,o);n.options.verbose&&n.options.logger.log(" <   "+JSON.stringify(i,null,2).split("\n").join("\n <   ")),e(i.error?r:null,i)};n.options.verbose&&n.options.logger.log("   > "+JSON.stringify(t,null,2).split("\n").join("\n   > ")),n.options.asyncRequestProcessing?n.engine.sendAsync(t,o):n._queueRequest(t,o)},p.prototype.close=function(t){this.manager.state.blockchain.close(t),this.engine.stop()},p.prototype._queueRequest=function(t,n){this._requestQueue||(this._requestQueue=[]),this._requestQueue.push({payload:t,callback:n}),e(this._processRequestQueue)},p.prototype._processRequestQueue=function(){const t=this;if(t._requestInProgress)return;t._requestInProgress=!0;let n=t._requestQueue.shift();n?t.engine.sendAsync(n.payload,(r,o)=>{t._requestQueue.length>0&&e(t._processRequestQueue),n.callback(r,o),t._requestInProgress=!1}):(t._requestInProgress=!1,t._requestQueue.length>0&&e(t._processRequestQueue))},p.prototype.cleanUpErrorObject=function(t,e){if(!t||!e.error)return e;let n={error:{data:{}}};return t.message?(n.error.message=t.message,n.error.data.stack=t.stack,n.error.data.name=t.name):e.error||(n.error={message:t.toString()}),f.merge(e,n)};let g=["eth_sendTransaction","eth_sendRawTransaction","personal_sendTransaction"];p.prototype._isTransactionRequest=function(t){return-1!==g.indexOf(t.method)},p.prototype.reportErrorInResponse=function(t,e,n){const r=this;return e?(r._isTransactionRequest(t)&&e instanceof l&&(n.result=e.hashes[0],r.options.vmErrorsOnRPCResponse?(n.error.data||(n.error.data={}),n.error.data[e.hashes[0]]=e.results[e.hashes[0]]):delete n.error),"eth_call"===t.method&&e instanceof l&&(r.options.vmErrorsOnRPCResponse?(n.error.data||(n.error.data={}),n.error.data[e.hashes[0]]=e.results[e.hashes[0]]):(n.result=e.results[e.hashes[0]].return||"0x",delete n.error)),r.cleanUpErrorObject(e,n)):n},t.exports=p}).call(this,n(12).setImmediate)},function(t,e){t.exports=require("web3-provider-engine")},function(t,e){t.exports=require("web3-provider-engine/subproviders/subscriptions")},function(t,e){t.exports=require("ethereumjs-abi")},function(t,e){t.exports=require("seedrandom")},function(t,e){t.exports=require("bip39")},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(30).Buffer,i=n(1),s=n(31),a=n(32),c=n(33),u=n(34);function l(t,e){if(!t)throw new Error(e||"Assertion failed")}function h(t,e){return o.concat([t.update(e),t.final()])}var f=function(t,e){if(t&&e)throw new Error("Cannot supply both a private and a public key to the constructor");if(t&&!i.isValidPrivate(t))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(e&&!i.isValidPublic(e))throw new Error("Invalid public key");this._privKey=t,this._pubKey=e};Object.defineProperty(f.prototype,"privKey",{get:function(){return l(this._privKey,"This is a public key only wallet"),this._privKey}}),Object.defineProperty(f.prototype,"pubKey",{get:function(){return this._pubKey||(this._pubKey=i.privateToPublic(this.privKey)),this._pubKey}}),f.generate=function(t){if(!t)return new f(s.randomBytes(32));for(var e=new i.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var n=s.randomBytes(32);if(new i.BN(i.privateToAddress(n)).lte(e))return new f(n)}},f.generateVanityAddress=function(t){for("object"!==(void 0===t?"undefined":r(t))&&(t=new RegExp(t));;){var e=s.randomBytes(32),n=i.privateToAddress(e);if(t.test(n.toString("hex")))return new f(e)}},f.prototype.getPrivateKey=function(){return this.privKey},f.prototype.getPrivateKeyString=function(){return i.bufferToHex(this.getPrivateKey())},f.prototype.getPublicKey=function(){return this.pubKey},f.prototype.getPublicKeyString=function(){return i.bufferToHex(this.getPublicKey())},f.prototype.getAddress=function(){return i.publicToAddress(this.pubKey)},f.prototype.getAddressString=function(){return i.bufferToHex(this.getAddress())},f.prototype.getChecksumAddressString=function(){return i.toChecksumAddress(this.getAddressString())},f.prototype.toV3=function(t,e){l(this._privKey,"This is a public key only wallet");var n,r=(e=e||{}).salt||s.randomBytes(32),u=e.iv||s.randomBytes(16),h=e.kdf||"scrypt",f={dklen:e.dklen||32,salt:r.toString("hex")};if("pbkdf2"===h)f.c=e.c||262144,f.prf="hmac-sha256",n=s.pbkdf2Sync(o.from(t),r,f.c,f.dklen,"sha256");else{if("scrypt"!==h)throw new Error("Unsupported kdf");f.n=e.n||262144,f.r=e.r||8,f.p=e.p||1,n=a(o.from(t),r,f.n,f.r,f.p,f.dklen)}var p=s.createCipheriv(e.cipher||"aes-128-ctr",n.slice(0,16),u);if(!p)throw new Error("Unsupported cipher");var d=o.concat([p.update(this.privKey),p.final()]),g=i.sha3(o.concat([n.slice(16,32),o.from(d,"hex")]));return{version:3,id:c({random:e.uuid||s.randomBytes(16)}),address:this.getAddress().toString("hex"),crypto:{ciphertext:d.toString("hex"),cipherparams:{iv:u.toString("hex")},cipher:e.cipher||"aes-128-ctr",kdf:h,kdfparams:f,mac:g.toString("hex")}}},f.prototype.getV3Filename=function(t){return["UTC--",(t?new Date(t):new Date).toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},f.prototype.toV3String=function(t,e){return JSON.stringify(this.toV3(t,e))},f.fromPublicKey=function(t,e){return e&&(t=i.importPublic(t)),new f(null,t)},f.fromExtendedPublicKey=function(t){return l("xpub"===t.slice(0,4),"Not an extended public key"),t=u.decode(t).slice(45),f.fromPublicKey(t,!0)},f.fromPrivateKey=function(t){return new f(t)},f.fromExtendedPrivateKey=function(t){l("xprv"===t.slice(0,4),"Not an extended private key");var e=u.decode(t);return l(0===e[45],"Invalid extended private key"),f.fromPrivateKey(e.slice(46))},f.fromV1=function(t,e){l("string"==typeof e);var n="object"===(void 0===t?"undefined":r(t))?t:JSON.parse(t);if("1"!==n.Version)throw new Error("Not a V1 wallet");if("scrypt"!==n.Crypto.KeyHeader.Kdf)throw new Error("Unsupported key derivation scheme");var c=n.Crypto.KeyHeader.KdfParams,u=a(o.from(e),o.from(n.Crypto.Salt,"hex"),c.N,c.R,c.P,c.DkLen),p=o.from(n.Crypto.CipherText,"hex");if(i.sha3(o.concat([u.slice(16,32),p])).toString("hex")!==n.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");var d=h(s.createDecipheriv("aes-128-cbc",i.sha3(u.slice(0,16)).slice(0,16),o.from(n.Crypto.IV,"hex")),p);return new f(d)},f.fromV3=function(t,e,n){l("string"==typeof e);var c,u,p="object"===(void 0===t?"undefined":r(t))?t:JSON.parse(n?t.toLowerCase():t);if(3!==p.version)throw new Error("Not a V3 wallet");if("scrypt"===p.crypto.kdf)u=p.crypto.kdfparams,c=a(o.from(e),o.from(u.salt,"hex"),u.n,u.r,u.p,u.dklen);else{if("pbkdf2"!==p.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(u=p.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");c=s.pbkdf2Sync(o.from(e),o.from(u.salt,"hex"),u.c,u.dklen,"sha256")}var d=o.from(p.crypto.ciphertext,"hex");if(i.sha3(o.concat([c.slice(16,32),d])).toString("hex")!==p.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");var g=h(s.createDecipheriv(p.crypto.cipher,c.slice(0,16),o.from(p.crypto.cipherparams.iv,"hex")),d);return new f(g)},f.fromEthSale=function(t,e){l("string"==typeof e);var n="object"===(void 0===t?"undefined":r(t))?t:JSON.parse(t),a=o.from(n.encseed,"hex"),c=s.pbkdf2Sync(e,e,2e3,32,"sha256").slice(0,16),u=h(s.createDecipheriv("aes-128-cbc",c,a.slice(0,16)),a.slice(16)),p=new f(i.sha3(u));if(p.getAddress().toString("hex")!==n.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return p},t.exports=f},function(t,e){t.exports=require("safe-buffer")},function(t,e){t.exports=require("crypto")},function(t,e){t.exports=require("scrypt.js")},function(t,e){t.exports=require("uuid/v4")},function(t,e){t.exports=require("bs58check")},function(t,e){t.exports=require("hdkey")},function(t,e,n){(function(e){var r=n(0),o=n(8),i=n(10),s=n(15),a=n(16),c=n(37),u=n(14),l=n(17),h=n(1),f=n(3),p=n(38),d=n(75),g=n(11),m=n(7);function b(t){if(g.apply(this),this.options=t=this._applyDefaultOptions(t||{}),this.logger=t.logger||console,this.data=new d(t),null!=t.trie&&null!=t.db_path)throw new Error("Can't initialize a TestRPC with a db and a custom trie.");this.pending_transactions=[],this.blockGasLimit=t.gasLimit,this.defaultTransactionGasLimit=t.defaultTransactionGasLimit,this.timeAdjustment=0}const y={gasLimit:"0x6691b7",defaultTransactionGasLimit:"0x15f90",time:null,debug:!1,allowUnlimitedContractSize:!1};b.prototype=Object.create(g.prototype),b.prototype.constructor=b,b.prototype._applyDefaultOptions=function(t){return m.merge(t,y,Object.assign({},t))},b.prototype.initialize=function(t,e){var n=this;this.data.initialize(function(o){if(o)return e(o);n.latestBlock(function(o,i){if(o)return e(o);var s=n.options,a=null;if(i&&(a=i.header.stateRoot),n.stateTrie=n.createStateTrie(n.data.trie_db,a),n.vm=s.vm||new c({state:n.stateTrie,blockchain:{getBlock:function(t,e){try{t=r.number(t)}catch(t){}n.getBlock(t,e)}},enableHomestead:!0,activatePrecompiles:!0,allowUnlimitedContractSize:s.allowUnlimitedContractSize}),!0===s.debug&&n.vm.on("step",function(t){var e=t.opcode.name,o=t.opcode.in;if(o){var i=t.stack.slice(-o).map(t=>r.hex(t)).join(" ");n.logger.log(`${e} ${i}`)}else n.logger.log(e)}),s.time&&n.setTime(s.time),i)return n.emit("block",i),e();n.createGenesisBlock(function(r,o){if(r)return e(r);t=t||[],f.eachSeries(t,function(t,e){n.putAccount(t.account,t.address,e)},function(t){if(t)return e(t);n.putBlock(o,[],[],e)})})})})},b.prototype.createStateTrie=function(t,e){return new l(this.data.trie_db,e)},b.prototype.createGenesisBlock=function(t){this.createBlock(t)},b.prototype.latestBlock=function(t){this.data.blocks.last(function(e,n){if(e)return t(e);t(null,n)})},b.prototype.getEffectiveBlockNumber=function(t,e){return"string"!=typeof t&&(t=r.hex(t)),t.indexOf("0x")>=0?e(null,r.number(t)):"latest"===t||"pending"===t?this.getHeight(e):"earliest"===t?e(null,0):void 0},b.prototype.getBlock=function(t,e){var n=this;if("string"!=typeof t&&(t=r.hex(t)),t.indexOf("0x")>=0){var o=t;if(!(o.length>40))return this.data.blocks.get(r.number(o),e);this.data.blockHashes.get(r.hex(o),function(t,r){return t?e(t):n.data.blocks.get(r,e)})}else{if("latest"===t||"pending"===t)return this.latestBlock(e);if("earliest"===t)return this.data.blocks.first(e)}},b.prototype.putBlock=function(t,e,n,o){var i=this;t.header.stateRoot=this.stateTrie.root,this.data.blocks.length(function(s,a){if(s)return o(s);var c=[i.data.blocks.push.bind(i.data.blocks,t),i.data.blockLogs.push.bind(i.data.blockLogs,e),i.data.blockHashes.set.bind(i.data.blockHashes,r.hex(t.hash()),a)];t.transactions.forEach(function(t,e){var o=r.hex(t.hash());c.push(i.data.transactions.set.bind(i.data.transactions,o,t),i.data.transactionReceipts.set.bind(i.data.transactionReceipts,o,n[e]))}),f.parallel(c,(e,n)=>{e||i.emit("block",t),o(e,n)})})},b.prototype.popBlock=function(t){var e=this;this.data.blocks.last(function(n,o){if(n)return t(n);if(null==o)return t(null,null);var i=[],s=r.hex(o.hash());o.transactions.forEach(function(t){var n=r.hex(t.hash());i.push(e.data.transactions.del.bind(e.data.transactions,n),e.data.transactionReceipts.del.bind(e.data.transactionReceipts,n))}),i.push(e.data.blockLogs.pop.bind(e.data.blockLogs),e.data.blockHashes.del.bind(e.data.blockHashes,s),e.data.blocks.pop.bind(e.data.blocks)),f.series(i,function(n){if(n)return t(n);e.data.blocks.last(function(n,r){if(n)return t(n);e.stateTrie.root=r.header.stateRoot,t(null,o)})})})},b.prototype.clearPendingTransactions=function(){this.pending_transactions=[]},b.prototype.putAccount=function(t,e,n){var r=this;e=h.toBuffer(e),this.vm.stateManager.putAccount(e,t,function(t){if(t)return n(t);r.vm.stateManager.cache.flush(n)})},b.prototype.createBlock=function(t,e){var n=this;"function"==typeof t&&(e=t,t=null);var o=new i;!function(e){if(t)return e(null,t);n.latestBlock(e)}(function(t,i){if(t)return e(t);var s=null!=i?r.number(i.header.number):-1;o.header.gasLimit=n.blockGasLimit,o.header.number=r.hex(s+1),o.header.timestamp=r.hex(n.currentTime()),null!=i&&(o.header.parentHash=r.hex(i.hash())),e(null,o)})},b.prototype.getQueuedNonce=function(t,n){var i=null;if(this.pending_transactions.forEach(function(e){if(r.hex(e.from)===r.hex(t)){var n=r.number(e.nonce)||0;(null===i||n>i)&&(i=n)}}),null!=i)return n(null,e.from([i+1]));this.stateTrie.get(t,function(t,e){if(t)return n(t);var r=new o(e);n(null,r.nonce)})},b.prototype.queueTransaction=function(t){this.pending_transactions.push(t)},b.prototype.sortByPriceAndNonce=function(){var t={};this.pending_transactions.forEach(e=>{const n=r.hex(e.from);t[n]?t[n].push(e):t[n]=[e]});var e=function(t,e){return parseInt(r.hex(t.nonce),16)-parseInt(r.hex(e.nonce),16)};Object.keys(t).forEach(n=>{t[n].sort(e)});var n=new p(function(t,e){return parseInt(r.hex(e.gasPrice),16)-parseInt(r.hex(t.gasPrice),16)});Object.keys(t).forEach(e=>{n.push(t[e].shift())});const o=[];for(;n.size()>0;){const e=n.pop();let i=r.hex(e.from);t[i].length>0&&n.push(t[i].shift()),o.push(e)}this.pending_transactions=o},b.prototype.processCall=function(t,e,n){var r,o=this,i=function(t,e,i){o.vm.stateManager.revert(function(s){i&&(o.stateTrie.root=r),n(t||s,e)})},s=function(t,e,s,a){if(s)return n(s);e&&(r=o.stateTrie.root,o.stateTrie.root=a.header.stateRoot),o.createBlock(a,function(r,s){if(r)return n(r);s.transactions.push(t),o.vm.stateManager.checkpoint();var a={tx:t,block:s,skipBalance:!0,skipNonce:!0};o.vm.runTx(a,function(n,r){if(n&&n instanceof Error==!1&&(n=new Error("VM error: "+n)),n)return i(n);n=u.fromResults([t],{results:[r]}),i(n,r,e)})})};"latest"===e?o.latestBlock(s.bind(null,t,!1)):o.getBlock(e,s.bind(null,t,!0))},b.prototype.processBlock=function(t,n,o){var i=this;"function"==typeof n&&(o=n,n=!0),i.vm.stateManager.checkpoint();var c=function(t){i.vm.stateManager.revert(function(e){o(t||e)})};i.vm.runBlock({block:t,generate:!0},function(l,f){if(l&&l instanceof Error==!1&&(l=new Error("VM error: "+l)),l)return c(l);l=u.fromResults(t.transactions,f);var p=[],d=[],g=0;f.results.forEach(function(t){g+=r.number(t.gasUsed)}),t.header.gasUsed=h.toBuffer(r.hex(g));for(var m=0;m<f.receipts.length;m++){var b=f.results[m],y=f.receipts[m],v=t.transactions[m],k=v.hash(),x=[];if(1===b.vm.exception)for(var _=0;_<y.logs.length;_++){for(var w=y.logs[_],B=r.hex(w[0]),T=[],S=0;S<w[1].length;S++)T.push(r.hex(w[1][S]));var A=r.hex(w[2]),E=new s({logIndex:r.hex(_),transactionIndex:r.hex(m),transactionHash:k,block:t,address:B,data:A,topics:T,type:"mined"});p.push(E),x.push(E)}let n=new a(v,t,x,b.gasUsed.toArrayLike(e),y.gasUsed,b.createdAddress,y.status,r.hex(b.bloom.bitvector));d.push(n)}!function(e){!0===n?i.vm.stateManager.commit(function(n){if(n)return c(n);i.putBlock(t,p,d,e)}):i.vm.stateManager.revert(e)}(function(e){if(e)return o(e);o(l,t.transactions,f)})})},b.prototype.processNextBlock=function(t,e){var n=this;"function"==typeof t&&(e=t,t=void 0),n.sortByPriceAndNonce();for(var o=[],i=0,s=r.number(n.blockGasLimit);n.pending_transactions.length>0;){var a=n.pending_transactions[0],c=r.number(a.gasLimit);if(!(i+c<=s))break;i+=c,n.pending_transactions.shift(),o.push(a)}if(0===o.length&&n.pending_transactions.length>0){return e("Unexpected error condition: next transaction exceeds block gas limit")}this.createBlock(function(i,s){if(i)return e(i);t&&(n.data.blocks.last(function(o,i){if(o)return e(o);i&&r.number(i.header.timestamp)>t&&n.logger.log("Waring: Setting the block timestamp ("+t+") that is earlier than the parent block one.")}),s.header.timestamp=r.hex(t),n.setTime(new Date(1e3*t))),Array.prototype.push.apply(s.transactions,o),n.processBlock(s,!0,e)})},b.prototype.processTransactionTrace=function(t,n,o){var i=this,s=r.hex(t),a="",c=null,u={currentDepth:-1,stack:[]},l={gas:0,returnValue:"",structLogs:[]};function h(t,o){var s=r.number(t.gasLeft),a=r.number(c.gasLimit)-s-l.gas;l.gas+=a;var h,f=null;if(!n.disableMemory&&(f=(f=e.from(t.memory).toString("hex")).match(/.{1,64}/g)||[]).length>0){var p=f[f.length-1];p.length<64&&(f[f.length-1]=p+new Array(64-p.length+1).join("0"))}h=n.disableStack?null:t.stack.map(t=>r.rpcDataHexString(t,64).replace("0x",""));var d={depth:t.depth,error:"",gas:s,gasCost:a,memory:f,op:t.opcode.name,pc:t.pc,stack:h,storage:null};n.disableStorage?(l.structLogs.push(d),o()):d=i.processStorageTrace(d,u,t,function(t,e){if(t)return o(t);l.structLogs.push(e),o()})}function f(t){c=t,(a=r.hex(t.hash()))===s&&i.vm.on("step",h)}function p(){a===s&&(i.vm.removeListener("step",h),i.vm.removeListener("beforeTx",f),i.vm.removeListener("afterTx",p))}i.vm.on("beforeTx",f),i.vm.on("afterTx",p),this.getTransactionReceipt(s,function(t,e){if(t)return o(t);if(!e)return o(new Error("Unknown transaction "+s));var n=e.block;i.getBlock(n.header.parentHash,function(t,e){if(t)return o(t);var a=i.stateTrie.root;i.stateTrie.root=e.header.stateRoot,i.createBlock(e,function(t,e){if(t)return o(t);for(var c=0;c<n.transactions.length;c++){var u=n.transactions[c];if(e.transactions.push(u),r.hex(u.hash())===s)break}i.processBlock(e,!1,function(t){t&&0===t.message.indexOf("VM Exception")&&(t=null),i.stateTrie.root=a,i.vm.removeListener("beforeTx",f),i.vm.removeListener("afterTx",p),i.vm.removeListener("step",h),o(t,l)})})})})},b.prototype.processStorageTrace=function(t,e,n,o){var i,s,a=n.opcode.name,c=n.opcode.in,u=n.stack.slice(-c).map(t=>r.hex(t));switch(e.currentDepth>n.depth&&e.stack.pop(),e.currentDepth<n.depth&&e.stack.push({}),e.currentDepth=n.depth,a){case"SSTORE":i=r.rpcDataHexString(u[1],64).replace("0x",""),s=r.rpcDataHexString(u[0],64).replace("0x",""),t.storage=Object.assign({},e.stack[e.currentDepth]),o(null,t),e.stack[e.currentDepth][i]=s;break;case"SLOAD":i=r.rpcDataHexString(u[0],64).replace("0x",""),this.vm.stateManager.getContractStorage(n.address,"0x"+i,function(n,a){if(n)return o(n);s=r.rpcDataHexString(a,64).replace("0x",""),e.stack[e.currentDepth][i]=s,t.storage=Object.assign({},e.stack[e.currentDepth]),o(null,t)});break;default:t.storage=Object.assign({},e.stack[e.currentDepth]),o(null,t)}},b.prototype.getAccount=function(t,e,n){var r=this;this.getBlock(e,function(e,i){if(e)return n(e);var s=r.stateTrie,a=s.root;r.stateTrie.root=i.header.stateRoot,s.get(h.toBuffer(t),function(t,e){if(s.root=a,t)return n(t);var r=new o(e);r.exists=!!e,n(null,r)})})},b.prototype.getNonce=function(t,e,n){this.getAccount(t,e,function(t,e){if(t)return n(t);n(null,e.nonce)})},b.prototype.getBalance=function(t,e,n){this.getAccount(t,e,function(t,e){if(t)return n(t);n(null,e.balance)})},b.prototype.getStorage=function(t,e,n,r){var i=this;this.getBlock(n,function(n,s){if(n)return r(n);var a=i.stateTrie,c=a.root;i.stateTrie.root=s.header.stateRoot,a.get(h.toBuffer(t),function(t,n){if(null!=t)return a.root=c,r(t);var i=new o(n);a.root=i.stateRoot,a.get(h.setLengthLeft(h.toBuffer(e),32),function(t,e){if(a.root=c,null!=t)return r(t);r(null,e)})})})},b.prototype.getCode=function(t,e,n){var r=this;this.getBlock(e,function(e,i){if(e)return n(e);var s=r.stateTrie,a=s.root;r.stateTrie.root=i.header.stateRoot,s.get(h.toBuffer(t),function(t,e){if(null!=t)return s.root=a,n(t);new o(e).getCode(s,function(t,e){if(s.root=a,t)return n(t);n(null,e)})})})},b.prototype.getTransaction=function(t,e){t=r.hex(t),this.data.transactions.get(t,function(t,n){if(t)return t.notFound?e(null,null):e(t);e(null,n)})},b.prototype.getTransactionReceipt=function(t,e){t=r.hex(t),this.data.transactionReceipts.get(t,function(t,n){if(t)return t.notFound?e(null,null):e(t);e(t,n)})},b.prototype.getBlockLogs=function(t,e){var n=this;this.getEffectiveBlockNumber(t,function(t,r){if(t)return e(t);n.data.blockLogs.get(r,e)})},b.prototype.getHeight=function(t){this.data.blocks.length(function(e,n){if(e)return t(e);t(null,n-1)})},b.prototype.currentTime=function(){return((new Date).getTime()/1e3|0)+this.timeAdjustment},b.prototype.increaseTime=function(t){return t<0&&(t=0),this.timeAdjustment+=t,this.timeAdjustment},b.prototype.setTime=function(t){var e=(new Date).getTime()/1e3|0,n=t.getTime()/1e3|0;this.timeAdjustment=n-e},b.prototype.close=function(t){this.data.close(t)},t.exports=b}).call(this,n(6).Buffer)},function(t,e){t.exports=require("ethereumjs-vm")},function(t,e){t.exports=require("heap")},function(t,e){t.exports=require("levelup")},function(t,e){t.exports=require("encoding-down")},function(t,e){t.exports=require("abstract-leveldown")},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("cachedown")},function(t,e,n){var r=n(0),o=n(1),i=n(9);t.exports={encode:function(t,e){var n=t.toJSON(!0);n.from=r.hex(t.from),n.hash=r.hex(t.hash()),e(null,n)},decode:function(t,e){e(null,new i({nonce:o.toBuffer(t.nonce),value:o.toBuffer(t.value),to:o.toBuffer(t.to),from:o.toBuffer(t.from),gasLimit:o.toBuffer(t.gasLimit),gasPrice:o.toBuffer(t.gasPrice),data:o.toBuffer(t.data),v:o.toBuffer(t.v),r:o.toBuffer(t.r),s:o.toBuffer(t.s)}))}}},function(t,e){t.exports=require("tmp")},function(t,e){t.exports=require("web3-core")},function(t,e){t.exports=require("web3-eth")},function(t,e){t.exports=require("web3-net")},function(t,e){t.exports=require("web3-eth-personal")},function(t,e){t.exports=require("web3-shh")},function(t,e){t.exports=require("web3-bzz")},function(t,e){t.exports=require("web3-utils")},function(t,e){t.exports=require("bn.js")},function(t,e){t.exports=require("eth-sig-util")},function(t,e,n){var r=n(0),o=n(20);t.exports={toJSON:function(t,e){return{number:r.rpcQuantityHexString(t.header.number),hash:r.hex(t.hash()),parentHash:r.hex(t.header.parentHash),mixHash:r.hex(t.header.mixHash),nonce:r.rpcDataHexString(r.hex(t.header.nonce),16),sha3Uncles:r.hex(t.header.uncleHash),logsBloom:r.hex(t.header.bloom),transactionsRoot:r.hex(t.header.transactionsTrie),stateRoot:r.hex(t.header.stateRoot),receiptsRoot:r.hex(t.header.receiptTrie),miner:r.hex(t.header.coinbase),difficulty:r.rpcQuantityHexString(t.header.difficulty),totalDifficulty:r.rpcQuantityHexString(t.header.difficulty),extraData:r.rpcDataHexString(t.header.extraData),size:r.hex(1e3),gasLimit:r.rpcQuantityHexString(t.header.gasLimit),gasUsed:r.rpcQuantityHexString(t.header.gasUsed),timestamp:r.rpcQuantityHexString(t.header.timestamp),transactions:t.transactions.map(function(n){return e?o.toJSON(n,t):r.hex(n.hash())}),uncles:[]}}}},function(t,e){t.exports=require("websocket")},function(t,e){t.exports=require("http")},function(t,e,n){n(60),t.exports=n(61)},function(t,e){t.exports=require("core-js/fn/promise")},function(t,e,n){n(4);const r=n(62)("ganache");try{const e=n(21).optionalDependencies,i=n(22).version!==e.web3,s=n(63).version!==e["ethereumjs-wallet"];i||s?o():(t.exports=n(64),t.exports._webpacked=!1,r("Optional dependencies installed; exporting ganache-core with native optional dependencies."))}catch(t){r(t),o()}function o(){try{t.exports=n(91),t.exports._webpacked=!0,r("Optional dependencies not installed; exporting ganache-core from `./build` directory.")}catch(t){throw r("ganache-core could not be exported; optional dependencies nor webpack build available for export."),t}}},function(t,e){t.exports=require("debug")},function(t){t.exports={_args:[["ethereumjs-wallet@0.6.2","C:\\Users\\David\\Desktop\\Code\\ganache-core"]],_development:!0,_from:"ethereumjs-wallet@0.6.2",_id:"ethereumjs-wallet@0.6.2",_inBundle:!1,_integrity:"sha512-DHEKPV9lYORM7dL8602dkb+AgdfzCYz2lxpdYQoD3OwG355LLDuivW9rGuLpDMCry/ORyBYV6n+QCo/71SwACg==",_location:"/ethereumjs-wallet",_optional:!0,_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"ethereumjs-wallet@0.6.2",name:"ethereumjs-wallet",escapedName:"ethereumjs-wallet",rawSpec:"0.6.2",saveSpec:null,fetchSpec:"0.6.2"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/ethereumjs-wallet/-/ethereumjs-wallet-0.6.2.tgz",_spec:"0.6.2",_where:"C:\\Users\\David\\Desktop\\Code\\ganache-core",author:{name:"Alex Beregszaszi",email:"alex@rtfs.hu"},bugs:{url:"https://github.com/ethereumjs/ethereumjs-wallet/issues"},dependencies:{"aes-js":"^3.1.1",bs58check:"^2.1.2","ethereumjs-util":"^5.2.0",hdkey:"^1.0.0","safe-buffer":"^5.1.2","scrypt.js":"^0.2.0",utf8:"^3.0.0",uuid:"^3.3.2"},description:"Utilities for handling Ethereum keys",devDependencies:{"babel-cli":"^6.26.0","babel-preset-env":"^1.7.0",coveralls:"^3.0.0",istanbul:"^0.4.5",mocha:"^5.2.0",standard:"^11.0.0"},files:["/*.js","test/"],homepage:"https://github.com/ethereumjs/ethereumjs-wallet",keywords:["ethereum","wallets","keys"],license:"MIT",main:"index.js",name:"ethereumjs-wallet",repository:{type:"git",url:"git+https://github.com/ethereumjs/ethereumjs-wallet.git"},scripts:{"build:dist":"babel src/ -d .",coverage:"istanbul cover _mocha",coveralls:"npm run build:dist && npm run coverage && coveralls <coverage/lcov.info",lint:"standard",prepublishOnly:"npm run lint && npm run test:build",test:"mocha ./src/test/*.js","test:build":"npm run build:dist && mocha ./test/*.js"},standard:{globals:["describe","it"],ignore:["./*.js"]},version:"0.6.2"}},function(t,e,n){n(4);const r=n(23),o=n(88);t.exports={server:function(t){return o.create(t)},provider:function(t){return new r(t)},_webpacked:!0}},function(t,e){t.exports=require("setimmediate")},function(t,e,n){var r=n(5);function o(){this.methods={eth_call:!0,eth_getStorageAt:!0,eth_sendTransaction:!0,eth_sendRawTransaction:!0,eth_newBlockFilter:!0,eth_getFilterChanges:!0,eth_getFilterLogs:!0},this.queue=[],this.isWorking=!1}(0,n(2).inherits)(o,r),t.exports=o,o.prototype.handleRequest=function(t,e,n){if(!0!==t.external||!0!==this.methods[t.method])return e();this.queue.push([t,e]),!1===this.isWorking&&this.processNext()},o.prototype.processNext=function(){var t=this;0!==this.queue.length?(this.isWorking=!0,(0,this.queue.shift()[1])(function(e,n,r){if(e)return r(e);r(),t.processNext()})):this.isWorking=!1}},function(t,e,n){var r=n(5),o=n(2).inherits,i=n(3),s=n(0);function a(){this.watching={}}o(a,r),t.exports=a,a.prototype.handleRequest=function(t,e,n){return"eth_newBlockFilter"===t.method?this.handleNewBlockFilter(t,e,n):"eth_getFilterChanges"===t.method?this.handleGetFilterChanges(t,e,n):void e()},a.prototype.handleNewBlockFilter=function(t,e,n){var r=this;e(function(t,e,n){if(t)return n();r.watching[e]=!0,n()})},a.prototype.handleGetFilterChanges=function(t,e,n){var r=this,o=t.params[0];if(!this.watching[o])return e();e(function(t,e,n){if(t)return n();var a,c,u;i.series([function(t){0!==e.length?(a=e[0],t()):r.emitPayload({method:"eth_blockNumber"},function(e,n){if(e)return t(e);u=s.number(n.result),t()})},function(t){if(u)return t();r.emitPayload({method:"eth_getBlockByHash",params:[a,!1]},function(e,n){if(e)return t(e);u=s.number(n.result.number),t()})},function(t){if(0===(u=s.number(u)))return c=void 0,t();u-=1,r.emitPayload({method:"eth_getBlockByNumber",params:[u,!1]},function(e,n){if(e)return t(e);c=n.result.hash,t()})}],function(t){c&&(e[0]=c),delete r.watching[o],n()})})}},function(t,e,n){var r=n(5);function o(){}(0,n(2).inherits)(o,r),t.exports=o,o.prototype.handleRequest=function(t,e,n){if("eth_estimateGas"!==t.method&&"eth_call"!==t.method)return e();var r=t.params[0];null==r.from?this.emitPayload({method:"eth_coinbase"},function(t,o){if(t)return n(t);var i=o.result;r.from=i,e()}):e()}},function(t,e,n){(function(e){var r=n(1),o=n(2).inherits,i=n(70),s=n(0),a=n(20),c=n(56),u=n(21);function l(t,n){var r=this;this.state=t.state||new i(t,n),this.options=t,this.initialized=!1,this.initialization_error=null,this.post_initialization_callbacks=[],this.state.initialize(function(t){t&&(r.initialization_error=t),r.initialized=!0;var n=r.post_initialization_callbacks;r.post_initialization_callbacks=[],n.forEach(function(t){e(function(){t(r.initialization_error,r.state)})})})}o(l,n(5)),l.prototype.waitForInitialization=function(t){!1===this.initialized?this.post_initialization_callbacks.push(t):t(this.initialization_error,this.state)},l.prototype.handleRequest=function(t,e,n){if(null!=this.initialization_error)return n(this.initialization_error);if(!1!==this.initialized){var r=this[t.method];if(null==r)return n(new Error("Method "+t.method+" not supported."));var o=t.params||[],i=[].concat(o),s=!1;if(this.requiresDefaultBlockParameter(t.method)&&i.length<r.length-1&&(i.push("latest"),s=!0),i.push(n),i.length>r.length||void 0!==r.minLength&&i.length<r.minLength||void 0===r.minLength&&i.length<r.length){var a=`Incorrect number of arguments. Method '${t.method}' requires `;return r.minLength?a+=`between ${r.minLength-1} and ${r.length-1} arguments. `:a+=`exactly ${r.length-1} arguments. `,a+=s?"Including the implicit block argument, r":"R",a+=`equest specified ${i.length-1} arguments: ${JSON.stringify(i)}.`,n(new Error(a))}r.apply(this,i)}else this.waitForInitialization(this.getDelayedHandler(t,e,n))},l.prototype.getDelayedHandler=function(t,e,n){var r=this;return function(o,i){o&&n(o),r.handleRequest(t,e,n)}},l.prototype.requiresDefaultBlockParameter=function(t){return!0==={eth_getBalance:!0,eth_getCode:!0,eth_getTransactionCount:!0,eth_getStorageAt:!0,eth_call:!0,eth_estimateGas:!0}[t]},l.prototype.eth_accounts=function(t){t(null,Object.keys(this.state.accounts))},l.prototype.eth_blockNumber=function(t){this.state.blockNumber(function(e,n){if(e)return t(e);t(null,s.hex(n))})},l.prototype.eth_coinbase=function(t){t(null,this.state.coinbase)},l.prototype.eth_mining=function(t){t(null,this.state.is_mining)},l.prototype.eth_hashrate=function(t){t(null,"0x0")},l.prototype.eth_gasPrice=function(t){t(null,r.addHexPrefix(this.state.gasPrice()))},l.prototype.eth_getBalance=function(t,e,n){this.state.getBalance(t,e,n)},l.prototype.eth_getCode=function(t,e,n){this.state.getCode(t,e,n)},l.prototype.eth_getBlockByNumber=function(t,e,n){this.state.blockchain.getBlock(t,function(t,r){if(t)return t.message&&t.message.indexOf("index out of range")>=0?n(null,null):n(t);n(null,c.toJSON(r,e))})},l.prototype.eth_getBlockByHash=function(t,e,n){this.eth_getBlockByNumber.apply(this,arguments)},l.prototype.eth_getBlockTransactionCountByNumber=function(t,e){this.state.blockchain.getBlock(t,function(t,n){if(t)return t.message.indexOf("index out of range")?e(null,0):e(t);e(null,n.transactions.length)})},l.prototype.eth_getBlockTransactionCountByHash=function(t,e){this.eth_getBlockTransactionCountByNumber.apply(this,arguments)},l.prototype.eth_getTransactionReceipt=function(t,e){this.state.getTransactionReceipt(t,function(t,n){if(t)return e(t);var r=null;n&&(r=n.toJSON()),e(null,r)})},l.prototype.eth_getTransactionByHash=function(t,e){this.state.getTransactionReceipt(t,function(t,n){if(t)return e(t);var r=null;n&&(r=a.toJSON(n.tx,n.block)),e(null,r)})},l.prototype.eth_getTransactionByBlockHashAndIndex=function(t,e,n){e=s.number(e),this.state.getBlock(t,function(t,r){if(t)return t.notFound?n(null,null):n(t);if(e>=r.transactions.length)return n(new Error("Transaction at index "+s.hex(e)+" does not exist in block."));var o=r.transactions[e],i=a.toJSON(o,r);n(null,i)})},l.prototype.eth_getTransactionByBlockNumberAndIndex=function(t,e,n){this.eth_getTransactionByBlockHashAndIndex(t,e,n)},l.prototype.eth_getTransactionCount=function(t,e,n){this.state.getTransactionCount(t,e,(t,e)=>(t&&t.message&&t.message.indexOf("index out of range")>=0&&(t=new Error("Unknown block number")),n(t,e)))},l.prototype.eth_sign=function(t,e,n){var r,o;try{r=this.state.sign(t,e)}catch(t){o=t}n(o,r)},l.prototype.eth_signTypedData=function(t,e,n){var r,o;try{r=this.state.signTypedData(t,e)}catch(t){o=t}n(o,r)},l.prototype.eth_sendTransaction=function(t,e){this.state.queueTransaction("eth_sendTransaction",t,null,e)},l.prototype.eth_sendRawTransaction=function(t,e){this.state.queueRawTransaction(t,e)},l.prototype.eth_call=function(t,e,n){t.gas||(t.gas=this.state.blockchain.blockGasLimit),this.state.queueTransaction("eth_call",t,e,n)},l.prototype.eth_estimateGas=function(t,e,n){t.gas||(t.gas=this.state.blockchain.blockGasLimit),this.state.queueTransaction("eth_estimateGas",t,e,n)},l.prototype.eth_getStorageAt=function(t,e,n,r){this.state.queueStorage(t,e,n,r)},l.prototype.eth_newBlockFilter=function(t){var e=r.addHexPrefix(r.intToHex(this.state.latestFilterId));this.state.latestFilterId+=1,t(null,e)},l.prototype.eth_getFilterChanges=function(t,e){var n=this.state.latestBlock().hash().toString("hex");this.state.mine(),e(null,[n])},l.prototype.eth_getLogs=function(t,e){this.state.getLogs(t,e)},l.prototype.eth_uninstallFilter=function(t,e){e(null,!0)},l.prototype.eth_protocolVersion=function(t){t(null,"63")},l.prototype.bzz_hive=function(t){t(null,[])},l.prototype.bzz_info=function(t){t(null,[])},l.prototype.shh_version=function(t){t(null,"2")},l.prototype.eth_getCompilers=function(t){t(null,[])},l.prototype.eth_syncing=function(t){t(null,!1)},l.prototype.net_listening=function(t){t(null,!0)},l.prototype.net_peerCount=function(t){t(null,0)},l.prototype.web3_clientVersion=function(t){t(null,"EthereumJS TestRPC/v"+u.version+"/ethereum-js")},l.prototype.web3_sha3=function(t,e){e(null,s.hex(r.sha3(t)))},l.prototype.net_version=function(t){t(null,this.state.net_version+"")},l.prototype.miner_start=function(t,e){e||"function"!=typeof t||(e=t,t=null),this.state.startMining(function(t){e(t,!0)})},l.prototype.miner_start.minLength=1,l.prototype.miner_stop=function(t){this.state.stopMining(function(e){t(e,!0)})},l.prototype.rpc_modules=function(t){t(null,{eth:"1.0",net:"1.0",rpc:"1.0",web3:"1.0",evm:"1.0",personal:"1.0"})},l.prototype.personal_listAccounts=function(t){t(null,Object.keys(this.state.personal_accounts))},l.prototype.personal_newAccount=function(t,e){var n=this.state.createAccount({generate:!0});this.state.accounts[n.address.toLowerCase()]=n,this.state.personal_accounts[n.address.toLowerCase()]=!0,this.state.account_passwords[n.address.toLowerCase()]=t,e(null,n.address)},l.prototype.personal_importRawKey=function(t,e,n){var r=this.state.createAccount({secretKey:t});this.state.accounts[r.address.toLowerCase()]=r,this.state.personal_accounts[r.address.toLowerCase()]=!0,this.state.account_passwords[r.address.toLowerCase()]=e,n(null,r.address)},l.prototype.personal_lockAccount=function(t,e){if(!0!==this.state.personal_accounts[t.toLowerCase()]){return e("Account not found")}delete this.state.unlocked_accounts[t.toLowerCase()],e(null,!0)},l.prototype.personal_unlockAccount=function(t,e,n,r){if(!0!==this.state.personal_accounts[t.toLowerCase()]){return r("Account not found")}var o=this.state.account_passwords[t.toLowerCase()];if(void 0!==o&&o!==e){return r("Invalid password")}this.state.unlocked_accounts[t.toLowerCase()]=!0,r(null,!0)},l.prototype.personal_sendTransaction=function(t,e,n){if(null!=t.from){var o=r.addHexPrefix(t.from).toLowerCase(),i=this;i.personal_unlockAccount(o,e,null,function(e){if(e)return n(e);i.state.queueTransaction("eth_sendTransaction",t,null,function(t,e){i.state.unlocked_accounts[o.toLowerCase()]=!1,n(t,e)})})}else{n("Sender not found")}},l.prototype.evm_snapshot=function(t){this.state.snapshot(t)},l.prototype.evm_revert=function(t,e){this.state.revert(t,e)},l.prototype.evm_increaseTime=function(t,e){e(null,this.state.blockchain.increaseTime(t))},l.prototype.evm_setTime=function(t,e){e(null,this.state.blockchain.setTime(t))},l.prototype.evm_mine=function(t,e){"function"==typeof t&&(e=t,t=void 0),this.state.processBlock(t,function(t){if(t)return e(t);e(t,"0x0")})},l.prototype.evm_mine.minLength=1,l.prototype.debug_traceTransaction=function(t,e,n){"function"==typeof e&&(n=e,e=[]),this.state.queueTransactionTrace(t,e,n)},l.prototype.eth_getUncleCountByBlockHash=function(t,e){e(null,"0x0")},l.prototype.eth_getUncleCountByBlockNumber=function(t,e){e(null,"0x0")},l.prototype.eth_getUncleByBlockHashAndIndex=function(t,e,n){n(null,{})},l.prototype.eth_getUncleByBlockNumberAndIndex=function(t,e,n){n(null,{})},l.prototype.eth_newPendingTransactionFilter=function(t){t(null,"0x00")},l.prototype.eth_getFilterLogs=function(t,e){e(null,[])},l.prototype.eth_getWork=function(t,e){e(null,[])},l.prototype.eth_submitWork=function(t,e,n,r){r(null,!1)},l.prototype.eth_submitHashrate=function(t,e,n){n(null,!1)},l.prototype.db_putString=function(t,e,n,r){r(null,!1)},l.prototype.db_getString=function(t,e,n){n(null,"")},l.prototype.db_putHex=function(t,e,n,r){r(null,!1)},l.prototype.db_getHex=function(t,e,n){n(null,"0x00")},l.prototype.shh_post=function(t,e,n,r,o,i,s){s(null,!1)},l.prototype.shh_newIdentity=function(t){t(null,"0x00")},l.prototype.shh_hasIdentity=function(t,e){e(null,!1)},l.prototype.shh_newGroup=function(t){t(null,"0x00")},l.prototype.shh_addToGroup=function(t,e){e(null,!1)},l.prototype.shh_newFilter=function(t,e,n){n(null,!1)},l.prototype.shh_uninstallFilter=function(t,e){e(null,!1)},l.prototype.shh_getFilterChanges=function(t,e){e(null,[])},l.prototype.shh_getMessages=function(t,e){e(null,!1)},t.exports=l}).call(this,n(12).setImmediate)},function(t,e,n){(function(e){var r=n(8),o=n(14),i=n(9),s=n(1),a=n(27),c=n(28),u=n(29),l=n(74),h=n(3),f=n(36),p=n(83),d=n(19),g=n(55),m=n(7),b=n(0),y=n(85),v=n(86);function k(t,e){this.options=t=this._applyDefaultOptions(t||{}),t.fork?this.blockchain=new p(t):this.blockchain=new f(t),this.vm=this.blockchain.vm,this.stateTrie=this.blockchain.stateTrie,this.accounts={},this.secure=!!t.secure,this.account_passwords={},this.personal_accounts={},this.total_accounts=t.total_accounts,this.coinbase=null,this.latest_filter_id=1,this.action_queue=[],this.action_processing=!1,this.snapshots=[],this.logger=t.logger,this.net_version=t.network_id,this.mnemonic=t.mnemonic,this.wallet=l.fromMasterSeed(c.mnemonicToSeed(this.mnemonic)),this.wallet_hdpath=t.hdPath,this.gasPriceVal=b.rpcQuantityHexString(t.gasPrice),this.is_mining=!0,this.blockTime=t.blockTime,this.is_mining_on_interval=!!t.blockTime,this.mining_interval_timeout=null,this._provider=e}const x={total_accounts:10,gasPrice:"0x77359400",default_balance_ether:100,unlocked_accounts:[],hdPath:"m/44'/60'/0'/0/"};k.prototype._applyDefaultOptions=function(t){if(t.seed||(t.seed=y.randomAlphaNumericString(10,a())),!t.mnemonic){let e=y.randomBytes(16,a(t.seed));t.mnemonic=c.entropyToMnemonic(e.toString("hex"))}return t.fork||t.network_id||(t.network_id=(new Date).getTime()),m.merge(t,x,Object.assign({},t))},k.prototype.initialize=function(t){var e=this,n=[];let r=b.hex(d.utils.toWei(e.options.default_balance_ether.toString(),"ether"));if(e.options.accounts)n=e.options.accounts.map(e.createAccount.bind(e));else{if(!e.total_accounts)return t(new Error("Cannot initialize chain: either options.accounts or options.total_accounts must be specified"));for(var o=0;o<e.total_accounts;o++)n.push(e.createAccount({index:o,balance:r}))}e.coinbase=b.hex(n[0].address),e.accounts={},n.forEach(function(t){e.accounts[t.address]=t,e.personal_accounts[t.address.toLowerCase()]=!0}),e.unlocked_accounts=e.options.unlocked_accounts.reduce(function(t,e){if(0!==(e+"").indexOf("0x")){let t=parseInt(e),r=n[t];if(!r)throw new Error(`Account at index ${t} not found. Max index available is ${n.length-1}.`);e=r.address.toLowerCase()}return t[e.toLowerCase()]=!0,t},{}),e.secure||n.forEach(function(t){e.unlocked_accounts[t.address.toLowerCase()]=t}),e.blockchain.initialize(n,function(n){if(n)return t(n);e.net_version||(e.net_version=e.blockchain.fork_version),e.is_mining_on_interval&&e.mineOnInterval(),t()})},k.prototype.mineOnInterval=function(){var t=this;clearTimeout(t.mining_interval_timeout),t.mining_interval_timeout=null,t.mining_interval_timeout=setTimeout(function(){t._provider.send({method:"evm_mine"},t.mineOnInterval.bind(t))},1e3*this.blockTime),this.mining_interval_timeout&&this.mining_interval_timeout.unref&&this.mining_interval_timeout.unref()},k.prototype.createAccount=function(t,e){var n;if(t.generate)n=u.generate().getPrivateKey();else if(t.secretKey)n=s.toBuffer(b.hex(t.secretKey));else{var o=void 0===t.index?e:t.index;n=this.wallet.derivePath(this.wallet_hdpath+o).getWallet().getPrivateKey()}var i=s.privateToPublic(n),a=s.publicToAddress(i),c=new r;return c.balance=b.hex(t.balance),{secretKey:n,publicKey:i,address:b.hex(a).toLowerCase(),account:c}},k.prototype.blockNumber=function(t){return this.blockchain.getHeight(t)},k.prototype.gasPrice=function(){return this.gasPriceVal},k.prototype.getBalance=function(t,e,n){this.blockchain.getBalance(t,e,function(t,e){e&&(e=b.rpcQuantityHexString(e)),n(t,e)})},k.prototype.getTransactionCount=function(t,e,n){this.blockchain.getNonce(t,e,function(t,e){e&&(e=b.rpcQuantityHexString(e)),n(t,e)})},k.prototype.getCode=function(t,e,n){this.blockchain.getCode(t,e,function(t,e){e&&(e=b.hex(e)),n(t,e)})},k.prototype.queueRawTransaction=function(t,n){var r=e.from(s.stripHexPrefix(t),"hex"),o=new i(r),a={from:o.from.toString("hex"),to:o.to.toString("hex"),gas:o.gasLimit.toString("hex"),gasPrice:o.gasPrice.toString("hex"),value:o.value.toString("hex"),data:o.data.toString("hex"),nonce:o.nonce.toString("hex")};o.v&&o.v.length>0&&o.r&&o.r.length>0&&o.s&&o.s.length>0&&(a.v=o.v.toString("hex"),a.r=o.r.toString("hex"),a.s=o.s.toString("hex")),this.queueTransaction("eth_sendRawTransaction",a,null,n)},k.prototype.queueStorage=function(t,e,n,r){this.action_queue.push({method:"eth_getStorageAt",address:s.addHexPrefix(t),position:s.addHexPrefix(e),block:n,callback:r}),this.processNextAction()},k.prototype.queueTransaction=function(t,e,n,r){if(null!=e.from){if(e.from=s.addHexPrefix(e.from).toLowerCase(),"eth_sendTransaction"===t&&null==this.accounts[e.from]&&null==this.unlocked_accounts[e.from])return r(new v("sender account not recognized"));if("eth_sendTransaction"===t&&null==this.unlocked_accounts[e.from])return r(new v("signer account is locked"));var o={gasPrice:"0x1",gasLimit:b.hex(this.blockchain.defaultTransactionGasLimit),value:"0x0"};if(null!=e.gas&&(o.gasLimit=s.addHexPrefix(e.gas)),null!=e.gasPrice?o.gasPrice=s.addHexPrefix(e.gasPrice):o.gasPrice=this.gasPriceVal,null!=e.to&&(o.to=s.addHexPrefix(e.to)),null!=e.value&&(o.value=s.addHexPrefix(e.value)),null!=e.data&&(o.data=s.addHexPrefix(e.data)),null!=e.nonce&&(o.nonce=s.addHexPrefix(e.nonce)),null!=e.v&&null!=e.s&&null!=e.v&&(o.v=s.addHexPrefix(e.v),o.r=s.addHexPrefix(e.r),o.s=s.addHexPrefix(e.s)),"0x0"!==o.to&&""!==o.to||delete o.to,o.to&&"string"!=typeof o.to)return r(new v("Invalid to address"));if(b.number(o.gasLimit)>b.number(this.blockchain.blockGasLimit))return r(new v("Exceeds block gas limit"));var a=s.toBuffer(e.from);try{new i(o).from=a}catch(t){return r(t)}this.action_queue.push({method:t,from:e.from,tx:o,callback:r,blockNumber:n}),this.processNextAction()}else r(new v("from not found; is required"))},k.prototype.queueTransactionTrace=function(t,e,n){this.action_queue.push({method:"debug_traceTransaction",hash:b.hex(t),params:e,callback:n}),this.processNextAction()},k.prototype.processNextAction=function(t){var e=this;if(!0===t||!0!==this.action_processing&&0!==this.action_queue.length){var n=this.action_queue.shift();this.action_processing=!0;var r=function(t,r){n.callback(t,r),e.action_queue.length>0?e.processNextAction(!0):e.action_processing=!1};if("function"==typeof n.method){var o=n.method();return r(null,o)}"eth_getStorageAt"===n.method?this.blockchain.getStorage(n.address,n.position,n.block,function(t,e){if(t)return r(t);e&&(e=s.rlp.decode(e)),e=b.hex(e||0),r(null,e)}):"debug_traceTransaction"===n.method?this.blockchain.processTransactionTrace(n.hash,n.params,r):"eth_sendTransaction"===n.method||"eth_sendRawTransaction"===n.method?this.processTransaction(n.from,n.tx,r):"eth_call"===n.method?this.processCall(n.from,n.tx,n.blockNumber,r):"eth_estimateGas"===n.method&&this.processGasEstimate(n.from,n.tx,n.blockNumber,r)}},k.prototype.sign=function(t,n){var r=this.accounts[b.hex(t).toLowerCase()];if(!r)throw new Error("cannot sign data; no private key");var o=r.secretKey,i=e.from(n.replace("0x",""),"hex"),a=s.hashPersonalMessage(i),c=s.ecsign(a,e.from(o));return s.toRpcSig(c.v,c.r,c.s)},k.prototype.signTypedData=function(t,e){var n=this.accounts[b.hex(t).toLowerCase()];if(!n)throw new Error("cannot sign data; no private key");if(!e.types)throw new Error("cannot sign data; types missing");if(!e.types.EIP712Domain)throw new Error("cannot sign data; EIP712Domain definition missing");if(!e.domain)throw new Error("cannot sign data; domain missing");if(!e.primaryType)throw new Error("cannot sign data; primaryType missing");if(!e.message)throw new Error("cannot sign data; message missing");return g.signTypedData(n.secretKey,{data:e})},k.prototype.printTransactionReceipt=function(t,e,n){var r=this;r.blockchain.getTransactionReceipt(t,function(o,i){if(o)return n(o);r.blockchain.latestBlock(function(o,s){if(o)return n(o);i=i.toJSON(),r.logger.log(""),r.logger.log("  Transaction: "+t),null!=i.contractAddress&&r.logger.log("  Contract created: "+i.contractAddress),r.logger.log("  Gas usage: "+parseInt(i.gasUsed,16)),r.logger.log("  Block Number: "+parseInt(i.blockNumber,16)),r.logger.log("  Block Time: "+new Date(1e3*b.number(s.header.timestamp)).toString()),e&&(r.logger.log("  Runtime Error: "+e.error),e.reason&&r.logger.log("  Revert reason: "+e.reason)),r.logger.log(""),n(null,t)})})},k.prototype.processBlock=function(t,e){var n=this;"function"==typeof t&&(e=t,t=null),n.blockchain.processNextBlock(t,function(t,r,i){if(t&&t instanceof o==!1)return e(t,r,i);h.eachSeries(r,function(e,r){var o=b.hex(e.hash()),i=null==t?{results:{}}:t;n.printTransactionReceipt(o,i.results[o],r)},e(t,r,i))})},k.prototype.processBlocks=function(t,e){var n=this;"function"==typeof t&&(e=t,t=null);var r=null,i=0;h.whilst(function(){return null==t?n.blockchain.pending_transactions.length>0:i<t},function(t){n.processBlock(function(e,n,s){if(i+=1,e){if(e instanceof o==!1)return t(e);null==r?r=e:r.combine(e)}t()})},function(t){e(t||r)})},k.prototype.processCall=function(t,e,n,r){var o=this;o.createFakeTransactionWithCorrectNonce(e,t,function(t,e){if(t)return r(t);o.blockchain.processCall(e,n,function(t,e){if(t)return r(t);var n="0x";return!e.error&&e.vm.return?n=b.hex(e.vm.return):e.error&&o.logger.log(`Error processing call: ${e.error}`),r(null,n)})})},k.prototype.processGasEstimate=function(t,e,n,r){var o=this;o.createFakeTransactionWithCorrectNonce(e,t,function(t,e){if(t)return r(t);o.blockchain.processCall(e,n,function(t,e){if(t)return r(t);var n="0x";return e.error?o.logger.log(`Error calculating gas estimate: ${e.error}`):n=e.gasRefund?b.hex(e.gasUsed.add(e.gasRefund)):b.hex(e.gasUsed),r(null,n)})})},k.prototype.processTransaction=function(t,e,n){var r=this;r.createFakeTransactionWithCorrectNonce(e,t,function(t,e){if(t)return n(t);r.blockchain.queueTransaction(e);var o=b.hex(e.hash());if(!1===r.is_mining||r.is_mining_on_interval)return n(null,o);r.processBlocks(function(t){if(t)return n(t);n(null,o)})})},k.prototype.getTransactionReceipt=function(t,e){this.blockchain.getTransactionReceipt(t,function(t,n){if(t&&t.notFound)return e(null,null);e(t,n)})},k.prototype.getBlock=function(t,e){this.blockchain.getBlock(t,e)},k.prototype.getLogs=function(t,e){var n=this,r=t.address&&(Array.isArray(t.address)?t.address:[t.address]);r=r&&r.map(function(t){return t.toLowerCase()});var o=t.topics||[];h.parallel({fromBlock:this.blockchain.getEffectiveBlockNumber.bind(this.blockchain,t.fromBlock||"latest"),toBlock:this.blockchain.getEffectiveBlockNumber.bind(this.blockchain,t.toBlock||"latest"),latestBlock:this.blockchain.getEffectiveBlockNumber.bind(this.blockchain,"latest")},function(t,i){if(t)return e(t);var s=i.fromBlock,a=i.toBlock,c=i.latestBlock;a>c&&(a=c);var u=[],l=s;h.whilst(function(){return l<=a},function(t){n.blockchain.getBlockLogs(l,function(e,n){if(e)return t(e);var i=r?n.filter(function(t){return r.indexOf(t.address.toLowerCase())>-1}):n;i=i.filter(function(t){for(var e=!0,n=0;n<o.length;n++){var r=o[n],i=t.topics[n];if(null!=r){var s=Array.isArray(r)?r.includes(i):r===i;if(n>=t.topics.length||!s){e=!1;break}}}return e}),u.push.apply(u,i),l+=1,t()})},function(t){if(t)return e(t);u=u.map(function(t){return t.toJSON()}),e(t,u)})})},k.prototype.snapshot=function(t){var e=this;this.blockchain.getHeight(function(n,r){if(n)return t(n);e.snapshots.push({blockNumber:r,timeAdjustment:e.blockchain.timeAdjustment}),e.logger.log("Saved snapshot #"+e.snapshots.length),t(null,b.hex(e.snapshots.length))})},k.prototype.revert=function(t,e){var n=this;if(t=s.bufferToInt(t),this.logger.log("Reverting to snapshot #"+t),t>this.snapshots.length)return!1;t-=1;var r=this.snapshots[t].timeAdjustment;h.whilst(function(){return n.snapshots.length>t},function(t){var e=n.snapshots.pop();h.during(function(t){n.blockchain.getHeight(function(n,r){if(n)return t(n);t(null,r>e.blockNumber)})},function(t){n.blockchain.popBlock(function(e){if(e)return t(e);t()})},t)},function(t){if(t)return e(t);n.blockchain.clearPendingTransactions(),n.blockchain.timeAdjustment=r,e(null,!0)})},k.prototype.hasContractCode=function(t,e){this.vm.stateManager.getContractCode(t,function(t,n){null!=t?e(t,!1):e(null,!0)})},k.prototype.startMining=function(t){this.is_mining=!0,this.is_mining_on_interval?(this.mineOnInterval(),t()):this.processBlocks(t)},k.prototype.stopMining=function(t){this.is_mining=!1,clearTimeout(this.mining_interval_timeout),this.mining_interval_timeout=null,t()},k.prototype.isUnlocked=function(t){return null!=this.unlocked_accounts[t.toLowerCase()]},k.prototype.createFakeTransactionWithCorrectNonce=function(t,e,n){this.blockchain.getQueuedNonce(e,(r,o)=>{if(r)return n(r);var s=new i(t);if(s.from=e,null==t.nonce)s.nonce=b.hex(o);else if(!s.nonce.equals(o)){const t=b.number(o),e=b.number(s.nonce);return n(new v(`the tx doesn't have the correct nonce. account has nonce of: ${t} tx has nonce of: ${e}`))}n(null,s)})},t.exports=k}).call(this,n(6).Buffer)},function(t,e){t.exports=require("base64-js")},function(t,e){t.exports=require("ieee754")},function(t,e){t.exports=require("isarray")},function(t,e,n){"use strict";var r=n(35),o=n(29);function i(){}function s(t){var e=new i;return e._hdkey=t,e}i.fromMasterSeed=function(t){return s(r.fromMasterSeed(t))},i.fromExtendedKey=function(t){return s(r.fromExtendedKey(t))},i.prototype.privateExtendedKey=function(){if(!this._hdkey.privateExtendedKey)throw new Error("This is a public key only wallet");return this._hdkey.privateExtendedKey},i.prototype.publicExtendedKey=function(){return this._hdkey.publicExtendedKey},i.prototype.derivePath=function(t){return s(this._hdkey.derive(t))},i.prototype.deriveChild=function(t){return s(this._hdkey.deriveChild(t))},i.prototype.getWallet=function(){return this._hdkey._privateKey?o.fromPrivateKey(this._hdkey._privateKey):o.fromPublicKey(this._hdkey._publicKey,!0)},t.exports=i},function(t,e,n){var r=n(76),o=n(77),i=n(39),s=n(40),a=n(78),c=n(44),u=n(45),l=n(79),h=n(80),f=n(81),p=n(82),d=n(46);function g(t){this.options=t}g.prototype.initialize=function(t){var e=this;function n(n,i){if(n)return t(n);e.db=i,e.blocks=new r("blocks",e.db,l),e.blockLogs=new r("blockLogs",e.db,new f(e)),e.blockHashes=new o("blockHashes",e.db),e.transactions=new o("transactions",e.db,u),e.transactionReceipts=new o("transactionReceipts",e.db,new p(e)),e.trie_db=new o("trie_db",e.db,h,h),t()}!function(t){e.options.db_path?t(null,e.options.db_path):d.dir(t)}(function(r,o){if(r)return t(r);i(e.options.db||s(c(o,a).maxSize(100)),{valueEncoding:"json"},n)})},g.prototype.close=function(t){t()},t.exports=g},function(t,e,n){var r=n(18);function o(t,e,n){this.db=r(e),this.db=this.db.sublevel(t),this.name=t,this.serializer=n||{encode:function(t,e){e(null,t)},decode:function(t,e){e(null,t)}}}o.prototype.length=function(t){this.db.get("length",function(e,n){if(e)return e.notFound?t(null,0):t(e);t(null,n)})},o.prototype._get=function(t,e){var n=this;this.db.get(t,function(t,r){if(t)return e(t);n.serializer.decode(r,e)})},o.prototype._put=function(t,e,n){var r=this;this.serializer.encode(e,function(e,o){if(e)return n(e);r.db.put(t,o,n)})},o.prototype.get=function(t,e){var n=this;this.length(function(r,o){return r?e(r):t>=o?e(new Error("LevelUpArrayAdapter named '"+n.name+"' index out of range: index "+t+"; length: "+o)):void n._get(t,e)})},o.prototype.push=function(t,e){var n=this;this.length(function(r,o){if(r)return e(r);n._put(o+"",t,function(t){if(t)return e(t);n.db.put("length",o+1,e)})})},o.prototype.pop=function(t){var e=this;this.length(function(n,r){if(n)return t(n);var o=r-1;e._get(o+"",function(n,r){if(n)return t(n);e.db.del(o+"",function(n){if(n)return t(n);e.db.put("length",o,function(e){if(e)return t(e);t(null,r)})})})})},o.prototype.last=function(t){var e=this;this.length(function(n,r){return n?t(n):0===r?t(null,null):void e._get(r-1+"",t)})},o.prototype.first=function(t){this._get("0",t)},t.exports=o},function(t,e,n){var r=n(18),o=n(3);function i(t,e,n,o,i){this.db=r(e,i),this.db=this.db.sublevel(t),this.name=t,this.valueserializer=n||{encode:function(t,e){e(null,t)},decode:function(t,e){e(null,t)}},this.keyserializer=o||{encode:function(t,e){e(null,t)},decode:function(t,e){e(null,t)}}}i.prototype.get=function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={}),this.keyserializer.encode(t,function(t,e){if(t)return n(t);r.db.get(e,function(t,e){if(t)return n(t);r.valueserializer.decode(e,function(t,e){if(t)return n(t);n(null,e)})})})},i.prototype.put=function(t,e,n,r){var o=this;"function"==typeof n&&(r=n,n={}),this.keyserializer.encode(t,function(t,n){if(t)return r(t);o.valueserializer.encode(e,function(t,e){if(t)return r(t);o.db.put(n,e,r)})})},i.prototype.set=i.prototype.put,i.prototype.del=function(t,e){var n=this;this.keyserializer.encode(t,function(t,r){if(t)return e(t);n.db.del(r,e)})},i.prototype.batch=function(t,e,n){var r=this;o.each(t,function(t,n){"put"===t.type?r.put(t.key,t.value,e,n):"del"===t.type?r.del(t.key,n):n(new Error("Unknown batch type",t.type))},function(t){if(t)return n(t);n()})},i.prototype.isOpen=function(){return!0},t.exports=i},function(t,e,n){var r=n(2),o=n(41).AbstractLevelDOWN,i=n(3),s=n(42),a=n(43);function c(t){this.location=t,o.call(this,t)}r.inherits(c,o),c.prototype._open=function(t,e){e(null,this)},c.prototype._put=function(t,e,n,r){s.writeFile(a.join(this.location,t),e,"utf8",r)},c.prototype._get=function(t,e,n){s.readFile(a.join(this.location,t),"utf8",function(t,e){if(t)return n(new Error("NotFound"));n(null,e)})},c.prototype._del=function(t,e,n){s.unlink(a.join(this.location,t),function(t){if(t)return t.message.indexOf("ENOENT")>=0?n():n(t);n()})},c.prototype._batch=function(t,e,n){var r=this;i.each(t,function(t,n){"put"===t.type?r.put(t.key,t.value,e,n):"del"===t.type?r.del(t.key,e,n):n(new Error("Unknown batch type",t.type))},function(t){if(t)return n(t);n()})},t.exports=function(t){return new c(t)}},function(t,e,n){var r=n(45),o=n(3),i=n(10);t.exports={encode:function(t,e){var n=t.toJSON(!0);o.map(t.transactions,function(t,e){r.encode(t,e)},function(t,r){if(t)return e(t);n.transactions=r,e(null,n)})},decode:function(t,e){var n=t.transactions;t.transactions=[];var s=new i(t);o.eachSeries(n,function(t,e){r.decode(t,function(t,n){if(t)return e(t);s.transactions.push(n),e()})},function(t){if(t)return e(t);e(null,s)})}}},function(t,e,n){var r=n(1),o=n(0);t.exports={encode:function(t,e){e(null,o.hex(t))},decode:function(t,e){e(null,r.toBuffer(t))}}},function(t,e,n){var r=n(15),o=n(3);function i(t){this.database=t}i.prototype.encode=function(t,e){e(null,t=t.map(function(t){return t.toJSON()}))},i.prototype.decode=function(t,e){var n=this;if(0===t.length)return e(null,[]);this.database.blockHashes.get(t[0].blockHash,function(i,s){if(i)return e(i);n.database.blocks.get(s,function(n,i){if(n)return e(n);o.map(t,function(t,e){e(null,new r({block:i,logIndex:t.logIndex,transactionIndex:t.transactionIndex,transactionHash:t.transactionHash,address:t.address,data:t.data,topics:t.topics,type:t.type}))},function(t,n){if(t)return e(t);e(null,n)})})})},t.exports=i},function(t,e,n){var r=n(16),o=n(3);function i(t){this.database=t}i.prototype.encode=function(t,e){e(null,t.toJSON())},i.prototype.decode=function(t,e){var n=this;this.database.transactions.get(t.transactionHash,function(i,s){if(i)return e(i);n.database.blockHashes.get(t.blockHash,function(i,a){if(i)return e(i);o.parallel({block:n.database.blocks.get.bind(n.database.blocks,a),logs:n.database.blockLogs.get.bind(n.database.blockLogs,a)},function(n,o){if(n)return e(n);e(null,new r(s,o.block,o.logs,t.gasUsed,t.cumulativeGasUsed,t.contractAddress,t.status,t.logsBloom))})})})},t.exports=i},function(t,e,n){var r=n(36),o=n(8),i=n(10),s=n(15),a=n(16),c=n(1),u=n(84),l=n(19),h=n(0),f=n(3),p=n(20),d=n(54);function g(t){if(this.options=t||{},null==t.fork)throw new Error("ForkedBlockchain must be passed a fork parameter.");if(this.fork=t.fork,this.forkBlockNumber=t.forkBlockNumber,this.forkVersion=null,"string"==typeof this.fork){if(this.fork.indexOf("@")>=0){var e=this.fork.split("@");this.fork=e[0],this.forkBlockNumber=parseInt(e[1])}this.fork=new l.providers.HttpProvider(this.fork)}this.time=t.time,this.storageTrieCache={},r.call(this,t),this.web3=new l(this.fork)}(0,n(2).inherits)(g,r),g.prototype.initialize=function(t,e){var n=this;this.web3.eth.net.getId(function(o,i){if(o)return e(o);n.forkVersion=i,r.prototype.initialize.call(n,t,function(t){if(t)return e(t);n.vm.stateManager._lookupStorageTrie=n.lookupStorageTrie.bind(n),n.vm.stateManager.cache._lookupAccount=n.getAccount.bind(n),n.vm.stateManager.getContractCode=n.getCode.bind(n),n.vm.stateManager.putContractCode=n.putCode.bind(n),e()})})},g.prototype.createStateTrie=function(t,e){return new u(t,e,{fork:this.fork,forkBlockNumber:this.forkBlockNumber,blockchain:this})},g.prototype.createGenesisBlock=function(t){var e=this,n=this.forkBlockNumber||"latest";e.web3.eth.getBlock(n,function(r,o){if(r)return t(r);!e.time&&e.forkBlockNumber&&(e.time=e.options.time=new Date(1e3*h.number(o.timestamp)),e.setTime(e.time)),n=h.hex(o.number),e.forkBlockNumber=e.options.forkBlockNumber=n,e.stateTrie.forkBlockNumber=n,e.createBlock(function(e,n){if(e)return t(e);n.header.number=c.toBuffer(h.number(o.number)+1),n.header.parentHash=c.toBuffer(o.hash),t(null,n)})})},g.prototype.createForkedStorageTrie=function(t){t=h.hex(t);var e=new u(this.data.trie_db,null,{address:t,stateTrie:this.stateTrie,blockchain:this,fork:this.fork,forkBlockNumber:this.forkBlockNumber});return this.storageTrieCache[t]=e,e},g.prototype.lookupStorageTrie=function(t,e){if(t=h.hex(t),null!=this.storageTrieCache[t])return e(null,this.storageTrieCache[t]);e(null,this.createForkedStorageTrie(t))},g.prototype.isFallbackBlock=function(t,e){var n=this;n.getEffectiveBlockNumber(t,function(t,r){if(t)return e(t);e(null,r<=h.number(n.forkBlockNumber))})},g.prototype.isBlockHash=function(t){return"string"==typeof t&&0===t.indexOf("0x")&&t.length>42},g.prototype.isFallbackBlockHash=function(t,e){if(!this.isBlockHash(t))return e(null,!1);this.data.blockHashes.get(t,function(t,n){if(t)return t.notFound?e(null,!0):e(t);e(null,!1)})},g.prototype.getFallbackBlock=function(t,e){"string"==typeof t&&t.length<66&&(t=this.web3.utils.toBN(t)),this.web3.eth.getBlock(t,!0,function(t,n){if(t)return e(t);if(null==n)return e();var r=new i;r.header.parentHash=c.toBuffer(n.parentHash),r.header.uncleHash=c.toBuffer(n.sha3Uncles),r.header.coinbase=c.toBuffer(n.miner),r.header.stateRoot=c.toBuffer(n.stateRoot),r.header.transactionTrie=c.toBuffer(n.transactionsRoot),r.header.receiptTrie=c.toBuffer(n.receiptsRoot),r.header.bloom=c.toBuffer(n.logsBloom),r.header.difficulty=c.toBuffer("0x"+n.totalDifficulty.toString(16)),r.header.number=c.toBuffer(n.number),r.header.gasLimit=c.toBuffer(n.gasLimit),r.header.gasUsed=c.toBuffer(n.gasUsed),r.header.timestamp=c.toBuffer(n.timestamp),r.header.extraData=c.toBuffer(n.extraData),(n.transactions||[]).forEach(function(t,e){r.transactions.push(p.fromJSON(t))}),r.hash=function(){return c.toBuffer(n.hash)},e(null,r)})},g.prototype.getBlock=function(t,e){var n=this;this.isFallbackBlockHash(t,function(o,i){return o?e(o):i?n.getFallbackBlock(t,e):void n.isFallbackBlock(t,function(o,i){if(o)return e(o);if(i)return n.getFallbackBlock(t,e);!function(t,e){n.isBlockHash(t)?e(null,t):n.getRelativeBlockNumber(t,e)}(t,function(t,o){if(t)return e(t);r.prototype.getBlock.call(n,o,e)})})})},g.prototype.getStorage=function(t,e,n,r){this.lookupStorageTrie(t,function(t,n){if(t)return r(t);n.get(e,r)})},g.prototype.getCode=function(t,e,n){var o=this;"function"==typeof e&&(n=e,e="latest"),e||(e="latest"),this.getEffectiveBlockNumber(e,function(i,s){if(i)return n(i);e=s,o.stateTrie.keyExists(t,function(i,s){if(i)return n(i);s&&e>h.number(o.forkBlockNumber)?r.prototype.getCode.call(o,t,e,n):(e>h.number(o.forkBlockNumber)&&(e="latest"),o.fetchCodeFromFallback(t,e,function(t,e){e&&(e=c.toBuffer(e)),n(t,e)}))})})},g.prototype.putCode=function(t,e,n){var r=this;r.vm.stateManager.cache.flush(()=>{t=c.toBuffer(t),this.stateTrie.get(t,function(i,s){if(i)return n(i);var a=new o(s);a.setCode(r.stateTrie,e,function(e,o){if(e)return n(e);r.stateTrie.put(t,a.serialize(),function(e){if(e)return n(e);r.vm.stateManager.putAccount(t,a,n)})})})})},g.prototype.getAccount=function(t,e,n){var o=this;"function"==typeof e&&(n=e,e="latest"),this.getEffectiveBlockNumber(e,function(i,s){if(i)return n(i);e=s,o.stateTrie.keyExists(t,function(i,s){if(i)return n(i);s&&e>h.number(o.forkBlockNumber)?r.prototype.getAccount.call(o,t,e,function(t,e){if(t)return n(t);n(null,e)}):o.fetchAccountFromFallback(t,e,n)})})},g.prototype.getTransaction=function(t,e){var n=this;r.prototype.getTransaction.call(this,t,function(r,o){return r?e(r):null!=o?e(null,o):void n.web3.eth.getTransaction(t,function(t,n){if(t)return e(t);n&&(n=p.fromJSON(n)),e(null,n)})})},g.prototype.getTransactionReceipt=function(t,e){var n=this;r.prototype.getTransactionReceipt.call(this,t,function(r,o){return r?e(r):o?e(null,o):void n.web3.eth.getTransactionReceipt(t,function(r,o){return r?e(r):o?void f.parallel({tx:n.getTransaction.bind(n,t),block:n.getBlock.bind(n,o.blockNumber)},function(t,n){if(t)return e(t);var r=o.logs.map(function(t){return new s(t)}),i=new a(n.tx,n.block,r,o.gasUsed,o.cumulativeGasUsed,o.contractAddress,o.status,h.hex(o.logsBloom));e(null,i)}):e()})})},g.prototype.fetchAccountFromFallback=function(t,e,n){var r=this;t=h.hex(t),f.parallel({code:this.fetchCodeFromFallback.bind(this,t,e),balance:this.fetchBalanceFromFallback.bind(this,t,e),nonce:this.fetchNonceFromFallback.bind(this,t,e)},function(t,e){if(t)return n(t);var i=e.code,s=e.balance,a=e.nonce,u=new o({nonce:a,balance:s});u.exists="0x"!==i||"0x0"!==s||"0x0"!==a,u.setCode(r.stateTrie,c.toBuffer(i),function(t){if(t)return n(t);n(null,u)})})},g.prototype.fetchCodeFromFallback=function(t,e,n){var r=this;t=h.hex(t),"function"==typeof e&&(n=e,e=this.forkBlockNumber),this.getSafeFallbackBlockNumber(e,function(e,o){if(e)return n(e);r.web3.eth.getCode(t,o,function(t,e){if(t)return n(t);e="0x"+c.toBuffer(e).toString("hex"),n(null,e)})})},g.prototype.fetchBalanceFromFallback=function(t,e,n){var r=this;t=h.hex(t),"function"==typeof e&&(n=e,e=this.forkBlockNumber),this.getSafeFallbackBlockNumber(e,function(e,o){if(e)return n(e);r.web3.eth.getBalance(t,o,function(t,e){if(t)return n(t);e="0x"+new d(e).toString(16),n(null,e)})})},g.prototype.fetchNonceFromFallback=function(t,e,n){var r=this;t=h.hex(t),"function"==typeof e&&(n=e,e=this.forkBlockNumber),this.getSafeFallbackBlockNumber(e,function(e,o){if(e)return n(e);r.web3.eth.getTransactionCount(t,o,function(t,e){if(t)return n(t);e="0x"+r.web3.utils.toBN(e).toString(16),n(null,e)})})},g.prototype.getHeight=function(t){this.latestBlock(function(e,n){if(e)return t(e);t(null,h.number(n.header.number))})},g.prototype.getRelativeBlockNumber=function(t,e){var n=this;this.getEffectiveBlockNumber(t,function(t,r){if(t)return e(t);e(null,r-h.number(n.forkBlockNumber)-1)})},g.prototype.getSafeFallbackBlockNumber=function(t,e){var n=h.number(this.forkBlockNumber);if(null==t)return e(null,n);this.getEffectiveBlockNumber(t,function(t,r){if(t)return e(t);r>n&&(r=n),e(null,r)})},g.prototype.getBlockLogs=function(t,e){var n=this;this.getEffectiveBlockNumber(t,function(o,i){if(o)return e(o);n.getRelativeBlockNumber(i,function(o,i){if(o)return e(o);i<0?n.getBlock(t,function(r,o){if(r)return e(r);n.web3.currentProvider.send({jsonrpc:"2.0",method:"eth_getLogs",params:[{fromBlock:h.hex(t),toBlock:h.hex(t)}],id:(new Date).getTime()},function(t,n){if(t)return e(t);var r=n.result.map(function(t){return t.block=o,new s(t)});e(null,r)})}):r.prototype.getBlockLogs.call(n,i,e)})})},g.prototype._checkpointTrie=function(){var t=this;r.prototype._checkpointTrie.call(this),Object.keys(this.storageTrieCache).forEach(function(e){t.storageTrieCache[e].customCheckpoint()})},g.prototype._revertTrie=function(){var t=this;r.prototype._revertTrie.call(this),Object.keys(this.storageTrieCache).forEach(function(e){var n=t.storageTrieCache[e];0===n.checkpoints.length?delete t.storageTrieCache[e]:n.customRevert()})},t.exports=g},function(t,e,n){var r=n(17),o=n(1),i=n(2).inherits,s=n(19),a=n(0);function c(t,e,n){r.call(this,t,e),this.address=n.address,this.fork=n.fork,this.forkBlockNumber=n.forkBlockNumber,this.blockchain=n.blockchain,this.web3=new s,this.web3.setProvider(this.fork),this.checkpoints=[]}i(c,r),c.prototype.keyExists=function(t,e){t=o.toBuffer(t),this.findPath(t,function(t,n,r,o){var i=!1;n&&0===r.length&&(i=!0),e(t,i)})},c.prototype.get=function(t,e,n){var i=this;"function"==typeof e&&(n=e,e=i.forkBlockNumber),e=a.rpcQuantityHexString(e),t=o.toBuffer(t),this.keyExists(t,function(s,c){if(s)return n(s);c?r.prototype.get.call(i,t,function(t,e){n(t,e)}):null==i.address?i.blockchain.fetchAccountFromFallback(t,e,function(t,e){if(t)return n(t);n(null,e.serialize())}):i.web3.eth.getStorageAt(a.hex(i.address),a.hex(t),e,function(t,e){if(t)return n(t);e=o.toBuffer(e),e=o.rlp.encode(e),n(null,e)})})},c.prototype.customCheckpoint=function(){this.checkpoints.push(this.root)},c.prototype.customRevert=function(){this.root=this.checkpoints.pop()},t.exports=c},function(t,e,n){(function(e){t.exports={randomBytes:function(t,n){for(var r=[],o=0;o<t;o++)r.push(255*n());return e.from(r)},randomAlphaNumericString:function(t,e){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let r="";for(var o=0;o<t;o++)r+=n.charAt(Math.floor((e||Math.random)()*n.length));return r}}}).call(this,n(6).Buffer)},function(t,e,n){function r(t){Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=t}(0,n(2).inherits)(r,Error),t.exports=r},function(t,e,n){const r=n(11);var o=n(56);function i(t){if(t=t||{},r.apply(this),!t.blockchain)throw new Error("RpcBlockTracker - no blockchain specified.");if(!t.blockchain.on)throw new Error("RpcBlockTracker - blockchain is not an EventEmitter.");this._blockchain=t.blockchain,this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.getTrackingBlock=this.getTrackingBlock.bind(this),this.awaitCurrentBlock=this.awaitCurrentBlock.bind(this),this._setCurrentBlock=this._setCurrentBlock.bind(this)}i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.getTrackingBlock=function(){return this._currentBlock},i.prototype.getCurrentBlock=function(){return this._currentBlock},i.prototype.awaitCurrentBlock=function(){const t=this;return this._currentBlock?this._currentBlock:new Promise(t=>this.once("block",t)).then(()=>t._currentBlock)},i.prototype.start=function(t={}){return this._blockchain.on("block",this._setCurrentBlock),Promise.resolve()},i.prototype.stop=function(){this._isRunning=!1,this._blockchain.removeListener("block",this._setCurrentBlock)},i.prototype._setCurrentBlock=function(t){let e=o.toJSON(t,!0);if(this._currentBlock&&this._currentBlock.hash===e.hash)return;const n=this._currentBlock;this._currentBlock=e,this.emit("latest",e),this.emit("sync",{block:e,oldBlock:n}),this.emit("block",e)},t.exports=i},function(t,e,n){n(4);var r=n(23),o=n(89),i=n(90),s=n(7);t.exports={create:function(t){var e=(t=c(t||{})).logger,n=new r(t),s=i(n,e);s.keepAliveTimeout=t.keepAliveTimeout;let a=0;const u={};s.on("connection",t=>{let e=a++;u[e]=t,t.on("close",()=>delete u[e])});var l=s.listen;s.listen=function(){var t=Array.prototype.slice.call(arguments),e=function(){};t.length>0&&("function"==typeof t[t.length-1]&&(e=t.pop()));t.push(function(t){if(t)return e(t);s.provider.manager.waitForInitialization(e)}),l.apply(s,t)},s.provider=n,t.ws&&o(s,n,e);var h=s.close;return s.close=function(t){var e=Array.prototype.slice.call(arguments);h.apply(s,e),s.provider.close(function(e){if(e)return t(e);Object.keys(u).forEach(t=>{try{u[t].destroy()}catch(t){}})})},s}};const a={logger:{log:function(){}},ws:!0,keepAliveTimeout:5e3};var c=function(t){return s.merge({},a,t)}},function(t,e,n){var r=n(57).server;function o(t,e){const n=this;n.provider=t,n.logger=e,n.connectionsBySubscriptionId={},n.connections={},n.connectionCounter=0,n._updateSubscriptions=n._updateSubscriptions.bind(n),n.manageConnection=n.manageConnection.bind(n),n._logPayload=n._logPayload.bind(n),n._handleRequest=n._handleRequest.bind(n),t.on("data",function(t,e){t||n._updateSubscriptions(e)})}t.exports=function(t,e,n){var i=new o(e,n),s=new r({httpServer:t,autoAcceptConnections:!0});return s.on("connect",i.manageConnection),s},o.prototype.manageConnection=function(t){const e=this;t.id=++e.connectionCounter,e.connections[t.id]={connection:t,subscriptions:{}},t.on("message",function(n){try{var r=JSON.parse(n.utf8Data)}catch(e){t.reject(400,"Bad Request")}e._logPayload(r),e._handleRequest(t,r)}),t.on("close",function(){Object.keys(e.connections[t.id].subscriptions).forEach(t=>{e.provider.send({jsonrpc:"2.0",method:"eth_unsubscribe",params:[t],id:(new Date).getTime()},function(n,r){n||delete e.connectionsBySubscriptionId[t]})}),delete e.connections[t.id]})},o.prototype._handleRequest=function(t,e){const n=this;switch(e.method){case"eth_subscribe":n.provider.send(e,function(e,r){!e&&r.result&&(n.connections[t.id].subscriptions[r.result]=!0,n.connectionsBySubscriptionId[r.result]=n.connections[t.id]),t.send(JSON.stringify(r))});break;case"eth_unsubscribe":n.provider.send(e,function(r,o){r||o.error?t&&t.send&&t.send(JSON.stringify(o)):(delete n.connections[t.id].subscriptions[e.params[0]],delete n.connectionsBySubscriptionId[e.params[0]],t.send(JSON.stringify(o)))});break;default:n.provider.send(e,function(e,n){t.send(JSON.stringify(n))})}},o.prototype._logPayload=function(t){const e=this;if(t instanceof Array)for(var n=0;n<t.length;n++){var r=t[n];e.logger.log(r.method)}else e.logger.log(t.method)},o.prototype._updateSubscriptions=function(t){this.connectionsBySubscriptionId[t.params.subscription].connection.send(JSON.stringify(t))}},function(t,e,n){(function(e){var r=n(58);t.exports=function(t,n){var o=r.createServer(function(r,o){var i=r.method,s=[];r.on("data",function(t){s.push(t)}).on("end",function(){s=e.concat(s).toString();var r={"Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, User-Agent","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"};switch(i){case"OPTIONS":r["Content-Type"]="text/plain",o.writeHead(200,r),o.end("");break;case"POST":var a;try{a=JSON.parse(s)}catch(t){return r["Content-Type"]="text/plain",o.writeHead(400,r),void o.end("400 Bad Request")}if(a instanceof Array)for(var c=0;c<a.length;c++){var u=a[c];n.log(u.method)}else n.log(a.method);t.send(a,function(t,e){r["Content-Type"]="application/json",o.writeHead(200,r),o.end(JSON.stringify(e))});break;default:o.writeHead(400,{"Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, User-Agent","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*","Content-Type":"text/plain"}),o.end("400 Bad Request")}})});return o.ganacheProvider=t,o}}).call(this,n(6).Buffer)},function(t,e,n){(function(e,r,o){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=23)}([function(t,e,n){var r=n(1);t.exports={hex:function(t){if("string"==typeof t){if(0===t.indexOf("0x"))return t.trim();t=new r.BN(t)}return"boolean"==typeof t&&(t=t?1:0),"number"==typeof t&&(t=r.intToHex(t)),"object"==typeof t&&(t=t.toString("hex")),r.addHexPrefix(t)},rpcQuantityHexString:function(t){return"0x"==(t="0x"+(t=this.hex(t)).replace("0x","").replace(/^0+/,""))&&(t="0x0"),t},rpcDataHexString:function(t,e){if("number"==typeof e)t=this.hex(t).replace("0x",""),t=new Array(e-t.length).fill("0").join("")+t;else{if(0===t.length)return"0x";(t=this.hex(t).replace("0x","")).length%2!=0&&(t="0"+t)}return"0x"+t},nullableRpcDataHexString:function(t,e){const n=this.rpcDataHexString(t,e);return"0x"===n?null:n},hexWithZeroPadding:function(t){const e=(t=this.hex(t)).replace("0x","");return 1&e.length?"0x0"+e:t},number:function(t){if("number"==typeof t)return t;if("string"==typeof t&&0!==t.indexOf("0x"))return parseInt(t,10);var e=r.toBuffer(t);return r.bufferToInt(e)}}},function(t,e){t.exports=n(1)},function(t,e){t.exports=n(2)},function(t,e){t.exports=n(3)},function(t,e){t.exports=n(5)},function(t,e){t.exports=n(7)},function(t,e){t.exports=n(4)},function(t,e){t.exports=n(8)},function(t,e,n){var r=n(2).inherits,o=n(0),i=n(31);function s(t,e){Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.results={},this.hashes=[],this.combine(t,e)}r(s,Error),s.prototype.combine=function(t,e){if(t instanceof s)for(var n=t,r=Object.keys(n.results),a=0;a<r.length;a++){var c=r[a];this.results[c]=n.results[c],Array.prototype.push.apply(this.hashes,n.hashes)}else{var u=e.results;for(a=0;a<t.length;a++){var l=t[a],h=u[a];if(1!==h.vm.exception){var f,p=o.hex(l.hash());this.hashes.push(p);var d=h.vm.return;d&&"08c379a0"===d.slice(0,4).toString("hex")&&(f=i.rawDecode(["string"],d.slice(4))[0]),this.results[p]={error:h.vm.exceptionError.error||h.vm.exceptionError,program_counter:h.vm.runState.programCounter,return:o.hex(h.vm.return),reason:f}}}}if(1===this.hashes.length){var g=this.results[this.hashes[0]],m="VM Exception while processing transaction: "+g.error;g.reason&&(m+=" "+g.reason),this.message=m}else{for(m="Multiple VM Exceptions while processing transactions: \n\n",a=0;a<this.hashes.length;a++)m+=(p=this.hashes[a])+": "+(g=this.results[p]).error,g.reason&&(m+=" "+g.reason),m+="\n";this.message=m}},s.prototype.count=function(){return Object.keys(this.results).length},s.fromResults=function(t,e){var n=new s(t,e);return 0===n.count()?null:n},t.exports=s},function(t,e){t.exports=n(9)},function(t,e){t.exports=n(10)},function(t,e,n){var r=n(0);function o(t){var e=this;Object.keys(t).forEach(function(n){e[n]=t[n]})}o.prototype.toJSON=function(){return{logIndex:r.rpcQuantityHexString(this.logIndex),transactionIndex:r.rpcQuantityHexString(this.transactionIndex),transactionHash:r.rpcDataHexString(this.transactionHash),blockHash:r.rpcDataHexString(this.block.hash()),blockNumber:r.rpcQuantityHexString(this.block.header.number),address:r.rpcDataHexString(this.address),data:r.rpcDataHexString(this.data),topics:this.topics,type:"mined"}},t.exports=o},function(t,e,n){var r=n(0);function o(t,e,n,r,o,i,s,a){this.tx=t,this.block=e,this.logs=n,this.gasUsed=r,this.cumulativeGasUsed=o,this.contractAddress=i,this.status=s,this.logsBloom=a,this.transactionIndex=0;for(var c=0;c<e.transactions.length;c++)if(e.transactions[c].hash().equals(t.hash())){this.transactionIndex=c;break}}o.prototype.toJSON=function(){return{transactionHash:r.rpcDataHexString(this.tx.hash()),transactionIndex:r.rpcQuantityHexString(this.transactionIndex),blockHash:r.rpcDataHexString(this.block.hash()),blockNumber:r.rpcQuantityHexString(this.block.header.number),gasUsed:r.rpcQuantityHexString(this.gasUsed),cumulativeGasUsed:r.rpcQuantityHexString(this.cumulativeGasUsed),contractAddress:null!=this.contractAddress?r.rpcDataHexString(this.contractAddress):null,logs:this.logs.map(function(t){return t.toJSON()}),status:r.rpcQuantityHexString(this.status),logsBloom:r.rpcDataHexString(this.logsBloom),v:r.rpcDataHexString(this.tx.v),r:r.rpcDataHexString(this.tx.r),s:r.rpcDataHexString(this.tx.s)}},t.exports=o},function(t,e){t.exports=n(11)},function(t,e,n){"use strict";var r=n(60).version,o=n(61),i=n(62),s=n(63),a=n(64),c=n(65),u=n(66),l=n(67),h=function(){var t=this;o.packageInit(this,arguments),this.version=r,this.utils=l,this.eth=new i(this),this.shh=new c(this),this.bzz=new u(this);var e=this.setProvider;this.setProvider=function(n,r){return e.apply(t,arguments),this.eth.setProvider(n,r),this.shh.setProvider(n,r),this.bzz.setProvider(n),!0}};h.version=r,h.utils=l,h.modules={Eth:i,Net:s,Personal:a,Shh:c,Bzz:u},o.addProviders(h),t.exports=h},function(t,e,n){var r=n(0),o=n(9),i=n(1);t.exports={toJSON:function(t,e){for(var n=0,o=0;o<e.transactions.length;o++)if(e.transactions[o].hash().equals(t.hash())){n=o;break}var i={hash:r.nullableRpcDataHexString(t.hash()),nonce:r.rpcQuantityHexString(t.nonce),blockHash:r.nullableRpcDataHexString(e.hash()),blockNumber:r.rpcQuantityHexString(e.header.number),transactionIndex:r.rpcQuantityHexString(n),from:r.nullableRpcDataHexString(t.from),to:r.nullableRpcDataHexString(t.to),value:r.rpcQuantityHexString(t.value),gas:r.rpcQuantityHexString(t.gasLimit),gasPrice:r.rpcQuantityHexString(t.gasPrice),input:r.nullableRpcDataHexString(t.data)};return t.v&&t.v.length>0&&t.r&&t.r.length>0&&t.s&&t.s.length>0&&(i.v=r.hex(t.v),i.r=r.hex(t.r),i.s=r.hex(t.s)),i},fromJSON:function(t){var e=new o({nonce:i.toBuffer(r.hex(t.nonce)),from:i.toBuffer(r.hex(t.from)),value:i.toBuffer(r.hex(t.value)),gasLimit:i.toBuffer(r.hex(t.gas)),gasPrice:i.toBuffer(r.hex(t.gasPrice)),data:i.toBuffer(r.hex(t.input))});if(t.v&&t.v.length>0&&t.r&&t.r.length>0&&t.s&&t.s.length>0&&(e.v=i.toBuffer(r.hex(t.v)),e.r=i.toBuffer(r.hex(t.r)),e.s=i.toBuffer(r.hex(t.s))),t.to){var n=i.toBuffer(r.hex(t.to));n.equals(i.toBuffer("0x0"))||(e.to=i.setLengthLeft(n,20))}return e}}},function(t,e,n){n(6);let o=n(24),i=n(25),s=n(26),a=n(27),c=n(28),u=n(29),l=n(73),h=n(8),f=n(13),p=n(5);function d(t){const e=this;f.call(this),this.options=t=e._applyDefaultOptions(t||{});let n=new u(t,this);this.engine=new o({blockTracker:new l({blockchain:n.state.blockchain})});let r=new i;this.engine.manager=n,this.engine.addProvider(new s),this.engine.addProvider(new a),this.engine.addProvider(r),this.engine.addProvider(new c),this.engine.addProvider(n),this.engine.setMaxListeners(100),this.engine.start(),this.manager=n,this.sendAsync=this.send.bind(this),this.send=this.send.bind(this),this.close=this.close.bind(this),this._queueRequest=this._queueRequest.bind(this),this._processRequestQueue=this._processRequestQueue.bind(this),r.on("data",function(t,n){e.emit("data",t,n)})}const g={vmErrorsOnRPCResponse:!0,verbose:!1,asyncRequestProcessing:!1,logger:{log:function(){}}};d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype._applyDefaultOptions=function(t){return p.merge({},g,t)},d.prototype.send=function(t,e){if("function"!=typeof e)throw new Error("No callback provided to provider's send function. As of web3 1.0, provider.send is no longer synchronous and must be passed a callback as its final argument.");let n=this,r=function(t){return p.cloneDeep(t)};t=Array.isArray(t)?t.map(r):r(t);let o=function(r,o){let i;if(o=p.cloneDeep(o),Array.isArray(o)){i=[];for(let e=0;e<o.length;e++)i.push(n.reportErrorInResponse(t[e],r,o[e]))}else i=n.reportErrorInResponse(t,r,o);n.options.verbose&&n.options.logger.log(" <   "+JSON.stringify(i,null,2).split("\n").join("\n <   ")),e(i.error?r:null,i)};n.options.verbose&&n.options.logger.log("   > "+JSON.stringify(t,null,2).split("\n").join("\n   > ")),n.options.asyncRequestProcessing?n.engine.sendAsync(t,o):n._queueRequest(t,o)},d.prototype.close=function(t){this.manager.state.blockchain.close(t),this.engine.stop()},d.prototype._queueRequest=function(t,e){this._requestQueue||(this._requestQueue=[]),this._requestQueue.push({payload:t,callback:e}),r(this._processRequestQueue)},d.prototype._processRequestQueue=function(){const t=this;if(t._requestInProgress)return;t._requestInProgress=!0;let e=t._requestQueue.shift();e?t.engine.sendAsync(e.payload,(n,o)=>{t._requestQueue.length>0&&r(t._processRequestQueue),e.callback(n,o),t._requestInProgress=!1}):(t._requestInProgress=!1,t._requestQueue.length>0&&r(t._processRequestQueue))},d.prototype.cleanUpErrorObject=function(t,e){if(!t||!e.error)return e;let n={error:{data:{}}};return t.message?(n.error.message=t.message,n.error.data.stack=t.stack,n.error.data.name=t.name):e.error||(n.error={message:t.toString()}),p.merge(e,n)};let m=["eth_sendTransaction","eth_sendRawTransaction","personal_sendTransaction"];d.prototype._isTransactionRequest=function(t){return-1!==m.indexOf(t.method)},d.prototype.reportErrorInResponse=function(t,e,n){const r=this;return e?(r._isTransactionRequest(t)&&e instanceof h&&(n.result=e.hashes[0],r.options.vmErrorsOnRPCResponse?(n.error.data||(n.error.data={}),n.error.data[e.hashes[0]]=e.results[e.hashes[0]]):delete n.error),"eth_call"===t.method&&e instanceof h&&(r.options.vmErrorsOnRPCResponse?(n.error.data||(n.error.data={}),n.error.data[e.hashes[0]]=e.results[e.hashes[0]]):(n.result=e.results[e.hashes[0]].return||"0x",delete n.error)),r.cleanUpErrorObject(e,n)):n},t.exports=d},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(34).Buffer,i=n(1),s=n(35),a=n(36),c=n(37),u=n(38);function l(t,e){if(!t)throw new Error(e||"Assertion failed")}function h(t,e){return o.concat([t.update(e),t.final()])}var f=function(t,e){if(t&&e)throw new Error("Cannot supply both a private and a public key to the constructor");if(t&&!i.isValidPrivate(t))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(e&&!i.isValidPublic(e))throw new Error("Invalid public key");this._privKey=t,this._pubKey=e};Object.defineProperty(f.prototype,"privKey",{get:function(){return l(this._privKey,"This is a public key only wallet"),this._privKey}}),Object.defineProperty(f.prototype,"pubKey",{get:function(){return this._pubKey||(this._pubKey=i.privateToPublic(this.privKey)),this._pubKey}}),f.generate=function(t){if(!t)return new f(s.randomBytes(32));for(var e=new i.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var n=s.randomBytes(32);if(new i.BN(i.privateToAddress(n)).lte(e))return new f(n)}},f.generateVanityAddress=function(t){for("object"!==(void 0===t?"undefined":r(t))&&(t=new RegExp(t));;){var e=s.randomBytes(32),n=i.privateToAddress(e);if(t.test(n.toString("hex")))return new f(e)}},f.prototype.getPrivateKey=function(){return this.privKey},f.prototype.getPrivateKeyString=function(){return i.bufferToHex(this.getPrivateKey())},f.prototype.getPublicKey=function(){return this.pubKey},f.prototype.getPublicKeyString=function(){return i.bufferToHex(this.getPublicKey())},f.prototype.getAddress=function(){return i.publicToAddress(this.pubKey)},f.prototype.getAddressString=function(){return i.bufferToHex(this.getAddress())},f.prototype.getChecksumAddressString=function(){return i.toChecksumAddress(this.getAddressString())},f.prototype.toV3=function(t,e){l(this._privKey,"This is a public key only wallet");var n,r=(e=e||{}).salt||s.randomBytes(32),u=e.iv||s.randomBytes(16),h=e.kdf||"scrypt",f={dklen:e.dklen||32,salt:r.toString("hex")};if("pbkdf2"===h)f.c=e.c||262144,f.prf="hmac-sha256",n=s.pbkdf2Sync(o.from(t),r,f.c,f.dklen,"sha256");else{if("scrypt"!==h)throw new Error("Unsupported kdf");f.n=e.n||262144,f.r=e.r||8,f.p=e.p||1,n=a(o.from(t),r,f.n,f.r,f.p,f.dklen)}var p=s.createCipheriv(e.cipher||"aes-128-ctr",n.slice(0,16),u);if(!p)throw new Error("Unsupported cipher");var d=o.concat([p.update(this.privKey),p.final()]),g=i.sha3(o.concat([n.slice(16,32),o.from(d,"hex")]));return{version:3,id:c({random:e.uuid||s.randomBytes(16)}),address:this.getAddress().toString("hex"),crypto:{ciphertext:d.toString("hex"),cipherparams:{iv:u.toString("hex")},cipher:e.cipher||"aes-128-ctr",kdf:h,kdfparams:f,mac:g.toString("hex")}}},f.prototype.getV3Filename=function(t){return["UTC--",(t?new Date(t):new Date).toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},f.prototype.toV3String=function(t,e){return JSON.stringify(this.toV3(t,e))},f.fromPublicKey=function(t,e){return e&&(t=i.importPublic(t)),new f(null,t)},f.fromExtendedPublicKey=function(t){return l("xpub"===t.slice(0,4),"Not an extended public key"),t=u.decode(t).slice(45),f.fromPublicKey(t,!0)},f.fromPrivateKey=function(t){return new f(t)},f.fromExtendedPrivateKey=function(t){l("xprv"===t.slice(0,4),"Not an extended private key");var e=u.decode(t);return l(0===e[45],"Invalid extended private key"),f.fromPrivateKey(e.slice(46))},f.fromV1=function(t,e){l("string"==typeof e);var n="object"===(void 0===t?"undefined":r(t))?t:JSON.parse(t);if("1"!==n.Version)throw new Error("Not a V1 wallet");if("scrypt"!==n.Crypto.KeyHeader.Kdf)throw new Error("Unsupported key derivation scheme");var c=n.Crypto.KeyHeader.KdfParams,u=a(o.from(e),o.from(n.Crypto.Salt,"hex"),c.N,c.R,c.P,c.DkLen),p=o.from(n.Crypto.CipherText,"hex");if(i.sha3(o.concat([u.slice(16,32),p])).toString("hex")!==n.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");var d=h(s.createDecipheriv("aes-128-cbc",i.sha3(u.slice(0,16)).slice(0,16),o.from(n.Crypto.IV,"hex")),p);return new f(d)},f.fromV3=function(t,e,n){l("string"==typeof e);var c,u,p="object"===(void 0===t?"undefined":r(t))?t:JSON.parse(n?t.toLowerCase():t);if(3!==p.version)throw new Error("Not a V3 wallet");if("scrypt"===p.crypto.kdf)u=p.crypto.kdfparams,c=a(o.from(e),o.from(u.salt,"hex"),u.n,u.r,u.p,u.dklen);else{if("pbkdf2"!==p.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(u=p.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");c=s.pbkdf2Sync(o.from(e),o.from(u.salt,"hex"),u.c,u.dklen,"sha256")}var d=o.from(p.crypto.ciphertext,"hex");if(i.sha3(o.concat([c.slice(16,32),d])).toString("hex")!==p.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");var g=h(s.createDecipheriv(p.crypto.cipher,c.slice(0,16),o.from(p.crypto.cipherparams.iv,"hex")),d);return new f(g)},f.fromEthSale=function(t,e){l("string"==typeof e);var n="object"===(void 0===t?"undefined":r(t))?t:JSON.parse(t),a=o.from(n.encseed,"hex"),c=s.pbkdf2Sync(e,e,2e3,32,"sha256").slice(0,16),u=h(s.createDecipheriv("aes-128-cbc",c,a.slice(0,16)),a.slice(16)),p=new f(i.sha3(u));if(p.getAddress().toString("hex")!==n.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return p},t.exports=f},function(t,e,n){var r=n(0),i=n(7),s=n(10),a=n(11),c=n(12),u=n(41),l=n(8),h=n(19),f=n(1),p=n(3),d=n(42),g=n(43),m=n(13),b=n(5);function y(t){if(m.apply(this),this.options=t=this._applyDefaultOptions(t||{}),this.logger=t.logger||console,this.data=new g(t),null!=t.trie&&null!=t.db_path)throw new Error("Can't initialize a TestRPC with a db and a custom trie.");this.pending_transactions=[],this.blockGasLimit=t.gasLimit,this.defaultTransactionGasLimit=t.defaultTransactionGasLimit,this.timeAdjustment=0}const v={gasLimit:"0x6691b7",defaultTransactionGasLimit:"0x15f90",time:null,debug:!1,allowUnlimitedContractSize:!1};y.prototype=Object.create(m.prototype),y.prototype.constructor=y,y.prototype._applyDefaultOptions=function(t){return b.merge(t,v,Object.assign({},t))},y.prototype.initialize=function(t,e){var n=this;this.data.initialize(function(o){if(o)return e(o);n.latestBlock(function(o,i){if(o)return e(o);var s=n.options,a=null;if(i&&(a=i.header.stateRoot),n.stateTrie=n.createStateTrie(n.data.trie_db,a),n.vm=s.vm||new u({state:n.stateTrie,blockchain:{getBlock:function(t,e){try{t=r.number(t)}catch(t){}n.getBlock(t,e)}},enableHomestead:!0,activatePrecompiles:!0,allowUnlimitedContractSize:s.allowUnlimitedContractSize}),!0===s.debug&&n.vm.on("step",function(t){var e=t.opcode.name,o=t.opcode.in;if(o){var i=t.stack.slice(-o).map(t=>r.hex(t)).join(" ");n.logger.log(`${e} ${i}`)}else n.logger.log(e)}),s.time&&n.setTime(s.time),i)return n.emit("block",i),e();n.createGenesisBlock(function(r,o){if(r)return e(r);t=t||[],p.eachSeries(t,function(t,e){n.putAccount(t.account,t.address,e)},function(t){if(t)return e(t);n.putBlock(o,[],[],e)})})})})},y.prototype.createStateTrie=function(t,e){return new h(this.data.trie_db,e)},y.prototype.createGenesisBlock=function(t){this.createBlock(t)},y.prototype.latestBlock=function(t){this.data.blocks.last(function(e,n){if(e)return t(e);t(null,n)})},y.prototype.getEffectiveBlockNumber=function(t,e){return"string"!=typeof t&&(t=r.hex(t)),t.indexOf("0x")>=0?e(null,r.number(t)):"latest"===t||"pending"===t?this.getHeight(e):"earliest"===t?e(null,0):void 0},y.prototype.getBlock=function(t,e){var n=this;if("string"!=typeof t&&(t=r.hex(t)),t.indexOf("0x")>=0){var o=t;if(!(o.length>40))return this.data.blocks.get(r.number(o),e);this.data.blockHashes.get(r.hex(o),function(t,r){return t?e(t):n.data.blocks.get(r,e)})}else{if("latest"===t||"pending"===t)return this.latestBlock(e);if("earliest"===t)return this.data.blocks.first(e)}},y.prototype.putBlock=function(t,e,n,o){var i=this;t.header.stateRoot=this.stateTrie.root,this.data.blocks.length(function(s,a){if(s)return o(s);var c=[i.data.blocks.push.bind(i.data.blocks,t),i.data.blockLogs.push.bind(i.data.blockLogs,e),i.data.blockHashes.set.bind(i.data.blockHashes,r.hex(t.hash()),a)];t.transactions.forEach(function(t,e){var o=r.hex(t.hash());c.push(i.data.transactions.set.bind(i.data.transactions,o,t),i.data.transactionReceipts.set.bind(i.data.transactionReceipts,o,n[e]))}),p.parallel(c,(e,n)=>{e||i.emit("block",t),o(e,n)})})},y.prototype.popBlock=function(t){var e=this;this.data.blocks.last(function(n,o){if(n)return t(n);if(null==o)return t(null,null);var i=[],s=r.hex(o.hash());o.transactions.forEach(function(t){var n=r.hex(t.hash());i.push(e.data.transactions.del.bind(e.data.transactions,n),e.data.transactionReceipts.del.bind(e.data.transactionReceipts,n))}),i.push(e.data.blockLogs.pop.bind(e.data.blockLogs),e.data.blockHashes.del.bind(e.data.blockHashes,s),e.data.blocks.pop.bind(e.data.blocks)),p.series(i,function(n){if(n)return t(n);e.data.blocks.last(function(n,r){if(n)return t(n);e.stateTrie.root=r.header.stateRoot,t(null,o)})})})},y.prototype.clearPendingTransactions=function(){this.pending_transactions=[]},y.prototype.putAccount=function(t,e,n){var r=this;e=f.toBuffer(e),this.vm.stateManager.putAccount(e,t,function(t){if(t)return n(t);r.vm.stateManager.cache.flush(n)})},y.prototype.createBlock=function(t,e){var n=this;"function"==typeof t&&(e=t,t=null);var o=new s;!function(e){if(t)return e(null,t);n.latestBlock(e)}(function(t,i){if(t)return e(t);var s=null!=i?r.number(i.header.number):-1;o.header.gasLimit=n.blockGasLimit,o.header.number=r.hex(s+1),o.header.timestamp=r.hex(n.currentTime()),null!=i&&(o.header.parentHash=r.hex(i.hash())),e(null,o)})},y.prototype.getQueuedNonce=function(t,e){var n=null;if(this.pending_transactions.forEach(function(e){if(r.hex(e.from)===r.hex(t)){var o=r.number(e.nonce)||0;(null===n||o>n)&&(n=o)}}),null!=n)return e(null,o.from([n+1]));this.stateTrie.get(t,function(t,n){if(t)return e(t);var r=new i(n);e(null,r.nonce)})},y.prototype.queueTransaction=function(t){this.pending_transactions.push(t)},y.prototype.sortByPriceAndNonce=function(){var t={};this.pending_transactions.forEach(e=>{const n=r.hex(e.from);t[n]?t[n].push(e):t[n]=[e]});var e=function(t,e){return parseInt(r.hex(t.nonce),16)-parseInt(r.hex(e.nonce),16)};Object.keys(t).forEach(n=>{t[n].sort(e)});var n=new d(function(t,e){return parseInt(r.hex(e.gasPrice),16)-parseInt(r.hex(t.gasPrice),16)});Object.keys(t).forEach(e=>{n.push(t[e].shift())});const o=[];for(;n.size()>0;){const e=n.pop();let i=r.hex(e.from);t[i].length>0&&n.push(t[i].shift()),o.push(e)}this.pending_transactions=o},y.prototype.processCall=function(t,e,n){var r,o=this,i=function(t,e,i){o.vm.stateManager.revert(function(s){i&&(o.stateTrie.root=r),n(t||s,e)})},s=function(t,e,s,a){if(s)return n(s);e&&(r=o.stateTrie.root,o.stateTrie.root=a.header.stateRoot),o.createBlock(a,function(r,s){if(r)return n(r);s.transactions.push(t),o.vm.stateManager.checkpoint();var a={tx:t,block:s,skipBalance:!0,skipNonce:!0};o.vm.runTx(a,function(n,r){if(n&&n instanceof Error==0&&(n=new Error("VM error: "+n)),n)return i(n);n=l.fromResults([t],{results:[r]}),i(n,r,e)})})};"latest"===e?o.latestBlock(s.bind(null,t,!1)):o.getBlock(e,s.bind(null,t,!0))},y.prototype.processBlock=function(t,e,n){var i=this;"function"==typeof e&&(n=e,e=!0),i.vm.stateManager.checkpoint();var s=function(t){i.vm.stateManager.revert(function(e){n(t||e)})};i.vm.runBlock({block:t,generate:!0},function(u,h){if(u&&u instanceof Error==0&&(u=new Error("VM error: "+u)),u)return s(u);u=l.fromResults(t.transactions,h);var p=[],d=[],g=0;h.results.forEach(function(t){g+=r.number(t.gasUsed)}),t.header.gasUsed=f.toBuffer(r.hex(g));for(var m=0;m<h.receipts.length;m++){var b=h.results[m],y=h.receipts[m],v=t.transactions[m],k=v.hash(),x=[];if(1===b.vm.exception)for(var _=0;_<y.logs.length;_++){for(var w=y.logs[_],B=r.hex(w[0]),T=[],S=0;S<w[1].length;S++)T.push(r.hex(w[1][S]));var A=r.hex(w[2]),E=new a({logIndex:r.hex(_),transactionIndex:r.hex(m),transactionHash:k,block:t,address:B,data:A,topics:T,type:"mined"});p.push(E),x.push(E)}let e=new c(v,t,x,b.gasUsed.toArrayLike(o),y.gasUsed,b.createdAddress,y.status,r.hex(b.bloom.bitvector));d.push(e)}!function(n){!0===e?i.vm.stateManager.commit(function(e){if(e)return s(e);i.putBlock(t,p,d,n)}):i.vm.stateManager.revert(n)}(function(e){if(e)return n(e);n(u,t.transactions,h)})})},y.prototype.processNextBlock=function(t,e){var n=this;"function"==typeof t&&(e=t,t=void 0),n.sortByPriceAndNonce();for(var o=[],i=0,s=r.number(n.blockGasLimit);n.pending_transactions.length>0;){var a=n.pending_transactions[0],c=r.number(a.gasLimit);if(!(i+c<=s))break;i+=c,n.pending_transactions.shift(),o.push(a)}if(0===o.length&&n.pending_transactions.length>0)return e("Unexpected error condition: next transaction exceeds block gas limit");this.createBlock(function(i,s){if(i)return e(i);t&&(n.data.blocks.last(function(o,i){if(o)return e(o);i&&r.number(i.header.timestamp)>t&&n.logger.log("Waring: Setting the block timestamp ("+t+") that is earlier than the parent block one.")}),s.header.timestamp=r.hex(t),n.setTime(new Date(1e3*t))),Array.prototype.push.apply(s.transactions,o),n.processBlock(s,!0,e)})},y.prototype.processTransactionTrace=function(t,e,n){var i=this,s=r.hex(t),a="",c=null,u={currentDepth:-1,stack:[]},l={gas:0,returnValue:"",structLogs:[]};function h(t,n){var s=r.number(t.gasLeft),a=r.number(c.gasLimit)-s-l.gas;l.gas+=a;var h,f=null;if(!e.disableMemory&&(f=(f=o.from(t.memory).toString("hex")).match(/.{1,64}/g)||[]).length>0){var p=f[f.length-1];p.length<64&&(f[f.length-1]=p+new Array(64-p.length+1).join("0"))}h=e.disableStack?null:t.stack.map(t=>r.rpcDataHexString(t,64).replace("0x",""));var d={depth:t.depth,error:"",gas:s,gasCost:a,memory:f,op:t.opcode.name,pc:t.pc,stack:h,storage:null};e.disableStorage?(l.structLogs.push(d),n()):d=i.processStorageTrace(d,u,t,function(t,e){if(t)return n(t);l.structLogs.push(e),n()})}function f(t){c=t,(a=r.hex(t.hash()))===s&&i.vm.on("step",h)}function p(){a===s&&(i.vm.removeListener("step",h),i.vm.removeListener("beforeTx",f),i.vm.removeListener("afterTx",p))}i.vm.on("beforeTx",f),i.vm.on("afterTx",p),this.getTransactionReceipt(s,function(t,e){if(t)return n(t);if(!e)return n(new Error("Unknown transaction "+s));var o=e.block;i.getBlock(o.header.parentHash,function(t,e){if(t)return n(t);var a=i.stateTrie.root;i.stateTrie.root=e.header.stateRoot,i.createBlock(e,function(t,e){if(t)return n(t);for(var c=0;c<o.transactions.length;c++){var u=o.transactions[c];if(e.transactions.push(u),r.hex(u.hash())===s)break}i.processBlock(e,!1,function(t){t&&0===t.message.indexOf("VM Exception")&&(t=null),i.stateTrie.root=a,i.vm.removeListener("beforeTx",f),i.vm.removeListener("afterTx",p),i.vm.removeListener("step",h),n(t,l)})})})})},y.prototype.processStorageTrace=function(t,e,n,o){var i,s,a=n.opcode.name,c=n.opcode.in,u=n.stack.slice(-c).map(t=>r.hex(t));switch(e.currentDepth>n.depth&&e.stack.pop(),e.currentDepth<n.depth&&e.stack.push({}),e.currentDepth=n.depth,a){case"SSTORE":i=r.rpcDataHexString(u[1],64).replace("0x",""),s=r.rpcDataHexString(u[0],64).replace("0x",""),t.storage=Object.assign({},e.stack[e.currentDepth]),o(null,t),e.stack[e.currentDepth][i]=s;break;case"SLOAD":i=r.rpcDataHexString(u[0],64).replace("0x",""),this.vm.stateManager.getContractStorage(n.address,"0x"+i,function(n,a){if(n)return o(n);s=r.rpcDataHexString(a,64).replace("0x",""),e.stack[e.currentDepth][i]=s,t.storage=Object.assign({},e.stack[e.currentDepth]),o(null,t)});break;default:t.storage=Object.assign({},e.stack[e.currentDepth]),o(null,t)}},y.prototype.getAccount=function(t,e,n){var r=this;this.getBlock(e,function(e,o){if(e)return n(e);var s=r.stateTrie,a=s.root;r.stateTrie.root=o.header.stateRoot,s.get(f.toBuffer(t),function(t,e){if(s.root=a,t)return n(t);var r=new i(e);r.exists=!!e,n(null,r)})})},y.prototype.getNonce=function(t,e,n){this.getAccount(t,e,function(t,e){if(t)return n(t);n(null,e.nonce)})},y.prototype.getBalance=function(t,e,n){this.getAccount(t,e,function(t,e){if(t)return n(t);n(null,e.balance)})},y.prototype.getStorage=function(t,e,n,r){var o=this;this.getBlock(n,function(n,s){if(n)return r(n);var a=o.stateTrie,c=a.root;o.stateTrie.root=s.header.stateRoot,a.get(f.toBuffer(t),function(t,n){if(null!=t)return a.root=c,r(t);var o=new i(n);a.root=o.stateRoot,a.get(f.setLengthLeft(f.toBuffer(e),32),function(t,e){if(a.root=c,null!=t)return r(t);r(null,e)})})})},y.prototype.getCode=function(t,e,n){var r=this;this.getBlock(e,function(e,o){if(e)return n(e);var s=r.stateTrie,a=s.root;r.stateTrie.root=o.header.stateRoot,s.get(f.toBuffer(t),function(t,e){if(null!=t)return s.root=a,n(t);new i(e).getCode(s,function(t,e){if(s.root=a,t)return n(t);n(null,e)})})})},y.prototype.getTransaction=function(t,e){t=r.hex(t),this.data.transactions.get(t,function(t,n){if(t)return t.notFound?e(null,null):e(t);e(null,n)})},y.prototype.getTransactionReceipt=function(t,e){t=r.hex(t),this.data.transactionReceipts.get(t,function(t,n){if(t)return t.notFound?e(null,null):e(t);e(t,n)})},y.prototype.getBlockLogs=function(t,e){var n=this;this.getEffectiveBlockNumber(t,function(t,r){if(t)return e(t);n.data.blockLogs.get(r,e)})},y.prototype.getHeight=function(t){this.data.blocks.length(function(e,n){if(e)return t(e);t(null,n-1)})},y.prototype.currentTime=function(){return((new Date).getTime()/1e3|0)+this.timeAdjustment},y.prototype.increaseTime=function(t){return t<0&&(t=0),this.timeAdjustment+=t,this.timeAdjustment},y.prototype.setTime=function(t){var e=(new Date).getTime()/1e3|0,n=t.getTime()/1e3|0;this.timeAdjustment=n-e},y.prototype.close=function(t){this.data.close(t)},t.exports=y},function(t,e){t.exports=n(17)},function(t,e){t.exports=n(18)},function(t,e,n){var r=n(0),o=n(1),i=n(9);t.exports={encode:function(t,e){var n=t.toJSON(!0);n.from=r.hex(t.from),n.hash=r.hex(t.hash()),e(null,n)},decode:function(t,e){e(null,new i({nonce:o.toBuffer(t.nonce),value:o.toBuffer(t.value),to:o.toBuffer(t.to),from:o.toBuffer(t.from),gasLimit:o.toBuffer(t.gasLimit),gasPrice:o.toBuffer(t.gasPrice),data:o.toBuffer(t.data),v:o.toBuffer(t.v),r:o.toBuffer(t.r),s:o.toBuffer(t.s)}))}}},function(t,e,n){var r=n(0),o=n(15);t.exports={toJSON:function(t,e){return{number:r.rpcQuantityHexString(t.header.number),hash:r.hex(t.hash()),parentHash:r.hex(t.header.parentHash),mixHash:r.hex(t.header.mixHash),nonce:r.rpcDataHexString(r.hex(t.header.nonce),16),sha3Uncles:r.hex(t.header.uncleHash),logsBloom:r.hex(t.header.bloom),transactionsRoot:r.hex(t.header.transactionsTrie),stateRoot:r.hex(t.header.stateRoot),receiptsRoot:r.hex(t.header.receiptTrie),miner:r.hex(t.header.coinbase),difficulty:r.rpcQuantityHexString(t.header.difficulty),totalDifficulty:r.rpcQuantityHexString(t.header.difficulty),extraData:r.rpcDataHexString(t.header.extraData),size:r.hex(1e3),gasLimit:r.rpcQuantityHexString(t.header.gasLimit),gasUsed:r.rpcQuantityHexString(t.header.gasUsed),timestamp:r.rpcQuantityHexString(t.header.timestamp),transactions:t.transactions.map(function(n){return e?o.toJSON(n,t):r.hex(n.hash())}),uncles:[]}}}},function(t,e,n){n(6);const r=n(16),o=n(74);t.exports={server:function(t){return o.create(t)},provider:function(t){return new r(t)},_webpacked:!0}},function(t,e){t.exports=n(24)},function(t,e){t.exports=n(25)},function(t,e,n){var r=n(4);function o(){this.methods={eth_call:!0,eth_getStorageAt:!0,eth_sendTransaction:!0,eth_sendRawTransaction:!0,eth_newBlockFilter:!0,eth_getFilterChanges:!0,eth_getFilterLogs:!0},this.queue=[],this.isWorking=!1}(0,n(2).inherits)(o,r),t.exports=o,o.prototype.handleRequest=function(t,e,n){if(!0!==t.external||!0!==this.methods[t.method])return e();this.queue.push([t,e]),!1===this.isWorking&&this.processNext()},o.prototype.processNext=function(){var t=this;0!==this.queue.length?(this.isWorking=!0,(0,this.queue.shift()[1])(function(e,n,r){if(e)return r(e);r(),t.processNext()})):this.isWorking=!1}},function(t,e,n){var r=n(4),o=n(2).inherits,i=n(3),s=n(0);function a(){this.watching={}}o(a,r),t.exports=a,a.prototype.handleRequest=function(t,e,n){return"eth_newBlockFilter"===t.method?this.handleNewBlockFilter(t,e,n):"eth_getFilterChanges"===t.method?this.handleGetFilterChanges(t,e,n):void e()},a.prototype.handleNewBlockFilter=function(t,e,n){var r=this;e(function(t,e,n){if(t)return n();r.watching[e]=!0,n()})},a.prototype.handleGetFilterChanges=function(t,e,n){var r=this,o=t.params[0];if(!this.watching[o])return e();e(function(t,e,n){if(t)return n();var a,c,u;i.series([function(t){0!==e.length?(a=e[0],t()):r.emitPayload({method:"eth_blockNumber"},function(e,n){if(e)return t(e);u=s.number(n.result),t()})},function(t){if(u)return t();r.emitPayload({method:"eth_getBlockByHash",params:[a,!1]},function(e,n){if(e)return t(e);u=s.number(n.result.number),t()})},function(t){if(0===(u=s.number(u)))return c=void 0,t();u-=1,r.emitPayload({method:"eth_getBlockByNumber",params:[u,!1]},function(e,n){if(e)return t(e);c=n.result.hash,t()})}],function(t){c&&(e[0]=c),delete r.watching[o],n()})})}},function(t,e,n){var r=n(4);function o(){}(0,n(2).inherits)(o,r),t.exports=o,o.prototype.handleRequest=function(t,e,n){if("eth_estimateGas"!==t.method&&"eth_call"!==t.method)return e();var r=t.params[0];null==r.from?this.emitPayload({method:"eth_coinbase"},function(t,o){if(t)return n(t);var i=o.result;r.from=i,e()}):e()}},function(t,e,n){var o=n(1),i=n(2).inherits,s=n(30),a=n(0),c=n(15),u=n(22),l=n(72);function h(t,e){var n=this;this.state=t.state||new s(t,e),this.options=t,this.initialized=!1,this.initialization_error=null,this.post_initialization_callbacks=[],this.state.initialize(function(t){t&&(n.initialization_error=t),n.initialized=!0;var e=n.post_initialization_callbacks;n.post_initialization_callbacks=[],e.forEach(function(t){r(function(){t(n.initialization_error,n.state)})})})}i(h,n(4)),h.prototype.waitForInitialization=function(t){!1===this.initialized?this.post_initialization_callbacks.push(t):t(this.initialization_error,this.state)},h.prototype.handleRequest=function(t,e,n){if(null!=this.initialization_error)return n(this.initialization_error);if(!1!==this.initialized){var r=this[t.method];if(null==r)return n(new Error("Method "+t.method+" not supported."));var o=t.params||[],i=[].concat(o),s=!1;if(this.requiresDefaultBlockParameter(t.method)&&i.length<r.length-1&&(i.push("latest"),s=!0),i.push(n),i.length>r.length||void 0!==r.minLength&&i.length<r.minLength||void 0===r.minLength&&i.length<r.length){var a=`Incorrect number of arguments. Method '${t.method}' requires `;return r.minLength?a+=`between ${r.minLength-1} and ${r.length-1} arguments. `:a+=`exactly ${r.length-1} arguments. `,a+=s?"Including the implicit block argument, r":"R",a+=`equest specified ${i.length-1} arguments: ${JSON.stringify(i)}.`,n(new Error(a))}r.apply(this,i)}else this.waitForInitialization(this.getDelayedHandler(t,e,n))},h.prototype.getDelayedHandler=function(t,e,n){var r=this;return function(o,i){o&&n(o),r.handleRequest(t,e,n)}},h.prototype.requiresDefaultBlockParameter=function(t){return!0==={eth_getBalance:!0,eth_getCode:!0,eth_getTransactionCount:!0,eth_getStorageAt:!0,eth_call:!0,eth_estimateGas:!0}[t]},h.prototype.eth_accounts=function(t){t(null,Object.keys(this.state.accounts))},h.prototype.eth_blockNumber=function(t){this.state.blockNumber(function(e,n){if(e)return t(e);t(null,a.hex(n))})},h.prototype.eth_coinbase=function(t){t(null,this.state.coinbase)},h.prototype.eth_mining=function(t){t(null,this.state.is_mining)},h.prototype.eth_hashrate=function(t){t(null,"0x0")},h.prototype.eth_gasPrice=function(t){t(null,o.addHexPrefix(this.state.gasPrice()))},h.prototype.eth_getBalance=function(t,e,n){this.state.getBalance(t,e,n)},h.prototype.eth_getCode=function(t,e,n){this.state.getCode(t,e,n)},h.prototype.eth_getBlockByNumber=function(t,e,n){this.state.blockchain.getBlock(t,function(t,r){if(t)return t.message&&t.message.indexOf("index out of range")>=0?n(null,null):n(t);n(null,u.toJSON(r,e))})},h.prototype.eth_getBlockByHash=function(t,e,n){this.eth_getBlockByNumber.apply(this,arguments)},h.prototype.eth_getBlockTransactionCountByNumber=function(t,e){this.state.blockchain.getBlock(t,function(t,n){if(t)return t.message.indexOf("index out of range")?e(null,0):e(t);e(null,n.transactions.length)})},h.prototype.eth_getBlockTransactionCountByHash=function(t,e){this.eth_getBlockTransactionCountByNumber.apply(this,arguments)},h.prototype.eth_getTransactionReceipt=function(t,e){this.state.getTransactionReceipt(t,function(t,n){if(t)return e(t);var r=null;n&&(r=n.toJSON()),e(null,r)})},h.prototype.eth_getTransactionByHash=function(t,e){this.state.getTransactionReceipt(t,function(t,n){if(t)return e(t);var r=null;n&&(r=c.toJSON(n.tx,n.block)),e(null,r)})},h.prototype.eth_getTransactionByBlockHashAndIndex=function(t,e,n){e=a.number(e),this.state.getBlock(t,function(t,r){if(t)return t.notFound?n(null,null):n(t);if(e>=r.transactions.length)return n(new Error("Transaction at index "+a.hex(e)+" does not exist in block."));var o=r.transactions[e],i=c.toJSON(o,r);n(null,i)})},h.prototype.eth_getTransactionByBlockNumberAndIndex=function(t,e,n){this.eth_getTransactionByBlockHashAndIndex(t,e,n)},h.prototype.eth_getTransactionCount=function(t,e,n){this.state.getTransactionCount(t,e,(t,e)=>(t&&t.message&&t.message.indexOf("index out of range")>=0&&(t=new Error("Unknown block number")),n(t,e)))},h.prototype.eth_sign=function(t,e,n){var r,o;try{r=this.state.sign(t,e)}catch(t){o=t}n(o,r)},h.prototype.eth_signTypedData=function(t,e,n){var r,o;try{r=this.state.signTypedData(t,e)}catch(t){o=t}n(o,r)},h.prototype.eth_sendTransaction=function(t,e){this.state.queueTransaction("eth_sendTransaction",t,null,e)},h.prototype.eth_sendRawTransaction=function(t,e){this.state.queueRawTransaction(t,e)},h.prototype.eth_call=function(t,e,n){t.gas||(t.gas=this.state.blockchain.blockGasLimit),this.state.queueTransaction("eth_call",t,e,n)},h.prototype.eth_estimateGas=function(t,e,n){t.gas||(t.gas=this.state.blockchain.blockGasLimit),this.state.queueTransaction("eth_estimateGas",t,e,n)},h.prototype.eth_getStorageAt=function(t,e,n,r){this.state.queueStorage(t,e,n,r)},h.prototype.eth_newBlockFilter=function(t){var e=o.addHexPrefix(o.intToHex(this.state.latestFilterId));this.state.latestFilterId+=1,t(null,e)},h.prototype.eth_getFilterChanges=function(t,e){var n=this.state.latestBlock().hash().toString("hex");this.state.mine(),e(null,[n])},h.prototype.eth_getLogs=function(t,e){this.state.getLogs(t,e)},h.prototype.eth_uninstallFilter=function(t,e){e(null,!0)},h.prototype.eth_protocolVersion=function(t){t(null,"63")},h.prototype.bzz_hive=function(t){t(null,[])},h.prototype.bzz_info=function(t){t(null,[])},h.prototype.shh_version=function(t){t(null,"2")},h.prototype.eth_getCompilers=function(t){t(null,[])},h.prototype.eth_syncing=function(t){t(null,!1)},h.prototype.net_listening=function(t){t(null,!0)},h.prototype.net_peerCount=function(t){t(null,0)},h.prototype.web3_clientVersion=function(t){t(null,"EthereumJS TestRPC/v"+l.version+"/ethereum-js")},h.prototype.web3_sha3=function(t,e){e(null,a.hex(o.sha3(t)))},h.prototype.net_version=function(t){t(null,this.state.net_version+"")},h.prototype.miner_start=function(t,e){e||"function"!=typeof t||(e=t,t=null),this.state.startMining(function(t){e(t,!0)})},h.prototype.miner_start.minLength=1,h.prototype.miner_stop=function(t){this.state.stopMining(function(e){t(e,!0)})},h.prototype.rpc_modules=function(t){t(null,{eth:"1.0",net:"1.0",rpc:"1.0",web3:"1.0",evm:"1.0",personal:"1.0"})},h.prototype.personal_listAccounts=function(t){t(null,Object.keys(this.state.personal_accounts))},h.prototype.personal_newAccount=function(t,e){var n=this.state.createAccount({generate:!0});this.state.accounts[n.address.toLowerCase()]=n,this.state.personal_accounts[n.address.toLowerCase()]=!0,this.state.account_passwords[n.address.toLowerCase()]=t,e(null,n.address)},h.prototype.personal_importRawKey=function(t,e,n){var r=this.state.createAccount({secretKey:t});this.state.accounts[r.address.toLowerCase()]=r,this.state.personal_accounts[r.address.toLowerCase()]=!0,this.state.account_passwords[r.address.toLowerCase()]=e,n(null,r.address)},h.prototype.personal_lockAccount=function(t,e){if(!0!==this.state.personal_accounts[t.toLowerCase()])return e("Account not found");delete this.state.unlocked_accounts[t.toLowerCase()],e(null,!0)},h.prototype.personal_unlockAccount=function(t,e,n,r){if(!0!==this.state.personal_accounts[t.toLowerCase()])return r("Account not found");var o=this.state.account_passwords[t.toLowerCase()];if(void 0!==o&&o!==e)return r("Invalid password");this.state.unlocked_accounts[t.toLowerCase()]=!0,r(null,!0)},h.prototype.personal_sendTransaction=function(t,e,n){if(null!=t.from){var r=o.addHexPrefix(t.from).toLowerCase(),i=this;i.personal_unlockAccount(r,e,null,function(e){if(e)return n(e);i.state.queueTransaction("eth_sendTransaction",t,null,function(t,e){i.state.unlocked_accounts[r.toLowerCase()]=!1,n(t,e)})})}else n("Sender not found")},h.prototype.evm_snapshot=function(t){this.state.snapshot(t)},h.prototype.evm_revert=function(t,e){this.state.revert(t,e)},h.prototype.evm_increaseTime=function(t,e){e(null,this.state.blockchain.increaseTime(t))},h.prototype.evm_setTime=function(t,e){e(null,this.state.blockchain.setTime(t))},h.prototype.evm_mine=function(t,e){"function"==typeof t&&(e=t,t=void 0),this.state.processBlock(t,function(t){if(t)return e(t);e(t,"0x0")})},h.prototype.evm_mine.minLength=1,h.prototype.debug_traceTransaction=function(t,e,n){"function"==typeof e&&(n=e,e=[]),this.state.queueTransactionTrace(t,e,n)},h.prototype.eth_getUncleCountByBlockHash=function(t,e){e(null,"0x0")},h.prototype.eth_getUncleCountByBlockNumber=function(t,e){e(null,"0x0")},h.prototype.eth_getUncleByBlockHashAndIndex=function(t,e,n){n(null,{})},h.prototype.eth_getUncleByBlockNumberAndIndex=function(t,e,n){n(null,{})},h.prototype.eth_newPendingTransactionFilter=function(t){t(null,"0x00")},h.prototype.eth_getFilterLogs=function(t,e){e(null,[])},h.prototype.eth_getWork=function(t,e){e(null,[])},h.prototype.eth_submitWork=function(t,e,n,r){r(null,!1)},h.prototype.eth_submitHashrate=function(t,e,n){n(null,!1)},h.prototype.db_putString=function(t,e,n,r){r(null,!1)},h.prototype.db_getString=function(t,e,n){n(null,"")},h.prototype.db_putHex=function(t,e,n,r){r(null,!1)},h.prototype.db_getHex=function(t,e,n){n(null,"0x00")},h.prototype.shh_post=function(t,e,n,r,o,i,s){s(null,!1)},h.prototype.shh_newIdentity=function(t){t(null,"0x00")},h.prototype.shh_hasIdentity=function(t,e){e(null,!1)},h.prototype.shh_newGroup=function(t){t(null,"0x00")},h.prototype.shh_addToGroup=function(t,e){e(null,!1)},h.prototype.shh_newFilter=function(t,e,n){n(null,!1)},h.prototype.shh_uninstallFilter=function(t,e){e(null,!1)},h.prototype.shh_getFilterChanges=function(t,e){e(null,[])},h.prototype.shh_getMessages=function(t,e){e(null,!1)},t.exports=h},function(t,e,n){var r=n(7),i=n(8),s=n(9),a=n(1),c=n(32),u=n(33),l=n(17),h=n(39),f=n(3),p=n(18),d=n(58),g=n(14),m=n(69),b=n(5),y=n(0),v=n(70),k=n(71);function x(t,e){this.options=t=this._applyDefaultOptions(t||{}),t.fork?this.blockchain=new d(t):this.blockchain=new p(t),this.vm=this.blockchain.vm,this.stateTrie=this.blockchain.stateTrie,this.accounts={},this.secure=!!t.secure,this.account_passwords={},this.personal_accounts={},this.total_accounts=t.total_accounts,this.coinbase=null,this.latest_filter_id=1,this.action_queue=[],this.action_processing=!1,this.snapshots=[],this.logger=t.logger,this.net_version=t.network_id,this.mnemonic=t.mnemonic,this.wallet=h.fromMasterSeed(u.mnemonicToSeed(this.mnemonic)),this.wallet_hdpath=t.hdPath,this.gasPriceVal=y.rpcQuantityHexString(t.gasPrice),this.is_mining=!0,this.blockTime=t.blockTime,this.is_mining_on_interval=!!t.blockTime,this.mining_interval_timeout=null,this._provider=e}const _={total_accounts:10,gasPrice:"0x77359400",default_balance_ether:100,unlocked_accounts:[],hdPath:"m/44'/60'/0'/0/"};x.prototype._applyDefaultOptions=function(t){if(t.seed||(t.seed=v.randomAlphaNumericString(10,c())),!t.mnemonic){let e=v.randomBytes(16,c(t.seed));t.mnemonic=u.entropyToMnemonic(e.toString("hex"))}return t.fork||t.network_id||(t.network_id=(new Date).getTime()),b.merge(t,_,Object.assign({},t))},x.prototype.initialize=function(t){var e=this,n=[];let r=y.hex(g.utils.toWei(e.options.default_balance_ether.toString(),"ether"));if(e.options.accounts)n=e.options.accounts.map(e.createAccount.bind(e));else{if(!e.total_accounts)return t(new Error("Cannot initialize chain: either options.accounts or options.total_accounts must be specified"));for(var o=0;o<e.total_accounts;o++)n.push(e.createAccount({index:o,balance:r}))}e.coinbase=y.hex(n[0].address),e.accounts={},n.forEach(function(t){e.accounts[t.address]=t,e.personal_accounts[t.address.toLowerCase()]=!0}),e.unlocked_accounts=e.options.unlocked_accounts.reduce(function(t,e){if(0!==(e+"").indexOf("0x")){let t=parseInt(e),r=n[t];if(!r)throw new Error(`Account at index ${t} not found. Max index available is ${n.length-1}.`);e=r.address.toLowerCase()}return t[e.toLowerCase()]=!0,t},{}),e.secure||n.forEach(function(t){e.unlocked_accounts[t.address.toLowerCase()]=t}),e.blockchain.initialize(n,function(n){if(n)return t(n);e.net_version||(e.net_version=e.blockchain.fork_version),e.is_mining_on_interval&&e.mineOnInterval(),t()})},x.prototype.mineOnInterval=function(){var t=this;clearTimeout(t.mining_interval_timeout),t.mining_interval_timeout=null,t.mining_interval_timeout=setTimeout(function(){t._provider.send({method:"evm_mine"},t.mineOnInterval.bind(t))},1e3*this.blockTime),this.mining_interval_timeout&&this.mining_interval_timeout.unref&&this.mining_interval_timeout.unref()},x.prototype.createAccount=function(t,e){var n;if(t.generate)n=l.generate().getPrivateKey();else if(t.secretKey)n=a.toBuffer(y.hex(t.secretKey));else{var o=void 0===t.index?e:t.index;n=this.wallet.derivePath(this.wallet_hdpath+o).getWallet().getPrivateKey()}var i=a.privateToPublic(n),s=a.publicToAddress(i),c=new r;return c.balance=y.hex(t.balance),{secretKey:n,publicKey:i,address:y.hex(s).toLowerCase(),account:c}},x.prototype.blockNumber=function(t){return this.blockchain.getHeight(t)},x.prototype.gasPrice=function(){return this.gasPriceVal},x.prototype.getBalance=function(t,e,n){this.blockchain.getBalance(t,e,function(t,e){e&&(e=y.rpcQuantityHexString(e)),n(t,e)})},x.prototype.getTransactionCount=function(t,e,n){this.blockchain.getNonce(t,e,function(t,e){e&&(e=y.rpcQuantityHexString(e)),n(t,e)})},x.prototype.getCode=function(t,e,n){this.blockchain.getCode(t,e,function(t,e){e&&(e=y.hex(e)),n(t,e)})},x.prototype.queueRawTransaction=function(t,e){var n=o.from(a.stripHexPrefix(t),"hex"),r=new s(n),i={from:r.from.toString("hex"),to:r.to.toString("hex"),gas:r.gasLimit.toString("hex"),gasPrice:r.gasPrice.toString("hex"),value:r.value.toString("hex"),data:r.data.toString("hex"),nonce:r.nonce.toString("hex")};r.v&&r.v.length>0&&r.r&&r.r.length>0&&r.s&&r.s.length>0&&(i.v=r.v.toString("hex"),i.r=r.r.toString("hex"),i.s=r.s.toString("hex")),this.queueTransaction("eth_sendRawTransaction",i,null,e)},x.prototype.queueStorage=function(t,e,n,r){this.action_queue.push({method:"eth_getStorageAt",address:a.addHexPrefix(t),position:a.addHexPrefix(e),block:n,callback:r}),this.processNextAction()},x.prototype.queueTransaction=function(t,e,n,r){if(null!=e.from){if(e.from=a.addHexPrefix(e.from).toLowerCase(),"eth_sendTransaction"===t&&null==this.accounts[e.from]&&null==this.unlocked_accounts[e.from])return r(new k("sender account not recognized"));if("eth_sendTransaction"===t&&null==this.unlocked_accounts[e.from])return r(new k("signer account is locked"));var o={gasPrice:"0x1",gasLimit:y.hex(this.blockchain.defaultTransactionGasLimit),value:"0x0"};if(null!=e.gas&&(o.gasLimit=a.addHexPrefix(e.gas)),null!=e.gasPrice?o.gasPrice=a.addHexPrefix(e.gasPrice):o.gasPrice=this.gasPriceVal,null!=e.to&&(o.to=a.addHexPrefix(e.to)),null!=e.value&&(o.value=a.addHexPrefix(e.value)),null!=e.data&&(o.data=a.addHexPrefix(e.data)),null!=e.nonce&&(o.nonce=a.addHexPrefix(e.nonce)),null!=e.v&&null!=e.s&&null!=e.v&&(o.v=a.addHexPrefix(e.v),o.r=a.addHexPrefix(e.r),o.s=a.addHexPrefix(e.s)),"0x0"!==o.to&&""!==o.to||delete o.to,o.to&&"string"!=typeof o.to)return r(new k("Invalid to address"));if(y.number(o.gasLimit)>y.number(this.blockchain.blockGasLimit))return r(new k("Exceeds block gas limit"));var i=a.toBuffer(e.from);try{new s(o).from=i}catch(t){return r(t)}this.action_queue.push({method:t,from:e.from,tx:o,callback:r,blockNumber:n}),this.processNextAction()}else r(new k("from not found; is required"))},x.prototype.queueTransactionTrace=function(t,e,n){this.action_queue.push({method:"debug_traceTransaction",hash:y.hex(t),params:e,callback:n}),this.processNextAction()},x.prototype.processNextAction=function(t){var e=this;if(!0===t||!0!==this.action_processing&&0!==this.action_queue.length){var n=this.action_queue.shift();this.action_processing=!0;var r=function(t,r){n.callback(t,r),e.action_queue.length>0?e.processNextAction(!0):e.action_processing=!1};if("function"==typeof n.method){var o=n.method();return r(null,o)}"eth_getStorageAt"===n.method?this.blockchain.getStorage(n.address,n.position,n.block,function(t,e){if(t)return r(t);e&&(e=a.rlp.decode(e)),e=y.hex(e||0),r(null,e)}):"debug_traceTransaction"===n.method?this.blockchain.processTransactionTrace(n.hash,n.params,r):"eth_sendTransaction"===n.method||"eth_sendRawTransaction"===n.method?this.processTransaction(n.from,n.tx,r):"eth_call"===n.method?this.processCall(n.from,n.tx,n.blockNumber,r):"eth_estimateGas"===n.method&&this.processGasEstimate(n.from,n.tx,n.blockNumber,r)}},x.prototype.sign=function(t,e){var n=this.accounts[y.hex(t).toLowerCase()];if(!n)throw new Error("cannot sign data; no private key");var r=n.secretKey,i=o.from(e.replace("0x",""),"hex"),s=a.hashPersonalMessage(i),c=a.ecsign(s,o.from(r));return a.toRpcSig(c.v,c.r,c.s)},x.prototype.signTypedData=function(t,e){var n=this.accounts[y.hex(t).toLowerCase()];if(!n)throw new Error("cannot sign data; no private key");if(!e.types)throw new Error("cannot sign data; types missing");if(!e.types.EIP712Domain)throw new Error("cannot sign data; EIP712Domain definition missing");if(!e.domain)throw new Error("cannot sign data; domain missing");if(!e.primaryType)throw new Error("cannot sign data; primaryType missing");if(!e.message)throw new Error("cannot sign data; message missing");return m.signTypedData(n.secretKey,{data:e})},x.prototype.printTransactionReceipt=function(t,e,n){var r=this;r.blockchain.getTransactionReceipt(t,function(o,i){if(o)return n(o);r.blockchain.latestBlock(function(o,s){if(o)return n(o);i=i.toJSON(),r.logger.log(""),r.logger.log("  Transaction: "+t),null!=i.contractAddress&&r.logger.log("  Contract created: "+i.contractAddress),r.logger.log("  Gas usage: "+parseInt(i.gasUsed,16)),r.logger.log("  Block Number: "+parseInt(i.blockNumber,16)),r.logger.log("  Block Time: "+new Date(1e3*y.number(s.header.timestamp)).toString()),e&&(r.logger.log("  Runtime Error: "+e.error),e.reason&&r.logger.log("  Revert reason: "+e.reason)),r.logger.log(""),n(null,t)})})},x.prototype.processBlock=function(t,e){var n=this;"function"==typeof t&&(e=t,t=null),n.blockchain.processNextBlock(t,function(t,r,o){if(t&&t instanceof i==0)return e(t,r,o);f.eachSeries(r,function(e,r){var o=y.hex(e.hash()),i=null==t?{results:{}}:t;n.printTransactionReceipt(o,i.results[o],r)},e(t,r,o))})},x.prototype.processBlocks=function(t,e){var n=this;"function"==typeof t&&(e=t,t=null);var r=null,o=0;f.whilst(function(){return null==t?n.blockchain.pending_transactions.length>0:o<t},function(t){n.processBlock(function(e,n,s){if(o+=1,e){if(e instanceof i==0)return t(e);null==r?r=e:r.combine(e)}t()})},function(t){e(t||r)})},x.prototype.processCall=function(t,e,n,r){var o=this;o.createFakeTransactionWithCorrectNonce(e,t,function(t,e){if(t)return r(t);o.blockchain.processCall(e,n,function(t,e){if(t)return r(t);var n="0x";return!e.error&&e.vm.return?n=y.hex(e.vm.return):e.error&&o.logger.log(`Error processing call: ${e.error}`),r(null,n)})})},x.prototype.processGasEstimate=function(t,e,n,r){var o=this;o.createFakeTransactionWithCorrectNonce(e,t,function(t,e){if(t)return r(t);o.blockchain.processCall(e,n,function(t,e){if(t)return r(t);var n="0x";return e.error?o.logger.log(`Error calculating gas estimate: ${e.error}`):n=e.gasRefund?y.hex(e.gasUsed.add(e.gasRefund)):y.hex(e.gasUsed),r(null,n)})})},x.prototype.processTransaction=function(t,e,n){var r=this;r.createFakeTransactionWithCorrectNonce(e,t,function(t,e){if(t)return n(t);r.blockchain.queueTransaction(e);var o=y.hex(e.hash());if(!1===r.is_mining||r.is_mining_on_interval)return n(null,o);r.processBlocks(function(t){if(t)return n(t);n(null,o)})})},x.prototype.getTransactionReceipt=function(t,e){this.blockchain.getTransactionReceipt(t,function(t,n){if(t&&t.notFound)return e(null,null);e(t,n)})},x.prototype.getBlock=function(t,e){this.blockchain.getBlock(t,e)},x.prototype.getLogs=function(t,e){var n=this,r=t.address&&(Array.isArray(t.address)?t.address:[t.address]);r=r&&r.map(function(t){return t.toLowerCase()});var o=t.topics||[];f.parallel({fromBlock:this.blockchain.getEffectiveBlockNumber.bind(this.blockchain,t.fromBlock||"latest"),toBlock:this.blockchain.getEffectiveBlockNumber.bind(this.blockchain,t.toBlock||"latest"),latestBlock:this.blockchain.getEffectiveBlockNumber.bind(this.blockchain,"latest")},function(t,i){if(t)return e(t);var s=i.fromBlock,a=i.toBlock,c=i.latestBlock;a>c&&(a=c);var u=[],l=s;f.whilst(function(){return l<=a},function(t){n.blockchain.getBlockLogs(l,function(e,n){if(e)return t(e);var i=r?n.filter(function(t){return r.indexOf(t.address.toLowerCase())>-1}):n;i=i.filter(function(t){for(var e=!0,n=0;n<o.length;n++){var r=o[n],i=t.topics[n];if(null!=r){var s=Array.isArray(r)?r.includes(i):r===i;if(n>=t.topics.length||!s){e=!1;break}}}return e}),u.push.apply(u,i),l+=1,t()})},function(t){if(t)return e(t);u=u.map(function(t){return t.toJSON()}),e(t,u)})})},x.prototype.snapshot=function(t){var e=this;this.blockchain.getHeight(function(n,r){if(n)return t(n);e.snapshots.push({blockNumber:r,timeAdjustment:e.blockchain.timeAdjustment}),e.logger.log("Saved snapshot #"+e.snapshots.length),t(null,y.hex(e.snapshots.length))})},x.prototype.revert=function(t,e){var n=this;if(t=a.bufferToInt(t),this.logger.log("Reverting to snapshot #"+t),t>this.snapshots.length)return!1;t-=1;var r=this.snapshots[t].timeAdjustment;f.whilst(function(){return n.snapshots.length>t},function(t){var e=n.snapshots.pop();f.during(function(t){n.blockchain.getHeight(function(n,r){if(n)return t(n);t(null,r>e.blockNumber)})},function(t){n.blockchain.popBlock(function(e){if(e)return t(e);t()})},t)},function(t){if(t)return e(t);n.blockchain.clearPendingTransactions(),n.blockchain.timeAdjustment=r,e(null,!0)})},x.prototype.hasContractCode=function(t,e){this.vm.stateManager.getContractCode(t,function(t,n){null!=t?e(t,!1):e(null,!0)})},x.prototype.startMining=function(t){this.is_mining=!0,this.is_mining_on_interval?(this.mineOnInterval(),t()):this.processBlocks(t)},x.prototype.stopMining=function(t){this.is_mining=!1,clearTimeout(this.mining_interval_timeout),this.mining_interval_timeout=null,t()},x.prototype.isUnlocked=function(t){return null!=this.unlocked_accounts[t.toLowerCase()]},x.prototype.createFakeTransactionWithCorrectNonce=function(t,e,n){this.blockchain.getQueuedNonce(e,(r,o)=>{if(r)return n(r);var i=new s(t);if(i.from=e,null==t.nonce)i.nonce=y.hex(o);else if(!i.nonce.equals(o)){const t=y.number(o),e=y.number(i.nonce);return n(new k(`the tx doesn't have the correct nonce. account has nonce of: ${t} tx has nonce of: ${e}`))}n(null,i)})},t.exports=x},function(t,e){t.exports=n(26)},function(t,e){t.exports=n(27)},function(t,e){t.exports=n(28)},function(t,e){t.exports=n(30)},function(t,e){t.exports=n(31)},function(t,e){t.exports=n(32)},function(t,e){t.exports=n(33)},function(t,e){t.exports=n(34)},function(t,e,n){"use strict";var r=n(40),o=n(17);function i(){}function s(t){var e=new i;return e._hdkey=t,e}i.fromMasterSeed=function(t){return s(r.fromMasterSeed(t))},i.fromExtendedKey=function(t){return s(r.fromExtendedKey(t))},i.prototype.privateExtendedKey=function(){if(!this._hdkey.privateExtendedKey)throw new Error("This is a public key only wallet");return this._hdkey.privateExtendedKey},i.prototype.publicExtendedKey=function(){return this._hdkey.publicExtendedKey},i.prototype.derivePath=function(t){return s(this._hdkey.derive(t))},i.prototype.deriveChild=function(t){return s(this._hdkey.deriveChild(t))},i.prototype.getWallet=function(){return this._hdkey._privateKey?o.fromPrivateKey(this._hdkey._privateKey):o.fromPublicKey(this._hdkey._publicKey,!0)},t.exports=i},function(t,e){t.exports=n(35)},function(t,e){t.exports=n(37)},function(t,e){t.exports=n(38)},function(t,e,n){var r=n(44),o=n(45),i=n(46),s=n(47),a=n(48),c=n(52),u=n(21),l=n(53),h=n(54),f=n(55),p=n(56),d=n(57);function g(t){this.options=t}g.prototype.initialize=function(t){var e=this;function n(n,i){if(n)return t(n);e.db=i,e.blocks=new r("blocks",e.db,l),e.blockLogs=new r("blockLogs",e.db,new f(e)),e.blockHashes=new o("blockHashes",e.db),e.transactions=new o("transactions",e.db,u),e.transactionReceipts=new o("transactionReceipts",e.db,new p(e)),e.trie_db=new o("trie_db",e.db,h,h),t()}!function(t){e.options.db_path?t(null,e.options.db_path):d.dir(t)}(function(r,o){if(r)return t(r);i(e.options.db||s(c(o,a).maxSize(100)),{valueEncoding:"json"},n)})},g.prototype.close=function(t){t()},t.exports=g},function(t,e,n){var r=n(20);function o(t,e,n){this.db=r(e),this.db=this.db.sublevel(t),this.name=t,this.serializer=n||{encode:function(t,e){e(null,t)},decode:function(t,e){e(null,t)}}}o.prototype.length=function(t){this.db.get("length",function(e,n){if(e)return e.notFound?t(null,0):t(e);t(null,n)})},o.prototype._get=function(t,e){var n=this;this.db.get(t,function(t,r){if(t)return e(t);n.serializer.decode(r,e)})},o.prototype._put=function(t,e,n){var r=this;this.serializer.encode(e,function(e,o){if(e)return n(e);r.db.put(t,o,n)})},o.prototype.get=function(t,e){var n=this;this.length(function(r,o){return r?e(r):t>=o?e(new Error("LevelUpArrayAdapter named '"+n.name+"' index out of range: index "+t+"; length: "+o)):void n._get(t,e)})},o.prototype.push=function(t,e){var n=this;this.length(function(r,o){if(r)return e(r);n._put(o+"",t,function(t){if(t)return e(t);n.db.put("length",o+1,e)})})},o.prototype.pop=function(t){var e=this;this.length(function(n,r){if(n)return t(n);var o=r-1;e._get(o+"",function(n,r){if(n)return t(n);e.db.del(o+"",function(n){if(n)return t(n);e.db.put("length",o,function(e){if(e)return t(e);t(null,r)})})})})},o.prototype.last=function(t){var e=this;this.length(function(n,r){return n?t(n):0===r?t(null,null):void e._get(r-1+"",t)})},o.prototype.first=function(t){this._get("0",t)},t.exports=o},function(t,e,n){var r=n(20),o=n(3);function i(t,e,n,o,i){this.db=r(e,i),this.db=this.db.sublevel(t),this.name=t,this.valueserializer=n||{encode:function(t,e){e(null,t)},decode:function(t,e){e(null,t)}},this.keyserializer=o||{encode:function(t,e){e(null,t)},decode:function(t,e){e(null,t)}}}i.prototype.get=function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={}),this.keyserializer.encode(t,function(t,e){if(t)return n(t);r.db.get(e,function(t,e){if(t)return n(t);r.valueserializer.decode(e,function(t,e){if(t)return n(t);n(null,e)})})})},i.prototype.put=function(t,e,n,r){var o=this;"function"==typeof n&&(r=n,n={}),this.keyserializer.encode(t,function(t,n){if(t)return r(t);o.valueserializer.encode(e,function(t,e){if(t)return r(t);o.db.put(n,e,r)})})},i.prototype.set=i.prototype.put,i.prototype.del=function(t,e){var n=this;this.keyserializer.encode(t,function(t,r){if(t)return e(t);n.db.del(r,e)})},i.prototype.batch=function(t,e,n){var r=this;o.each(t,function(t,n){"put"===t.type?r.put(t.key,t.value,e,n):"del"===t.type?r.del(t.key,n):n(new Error("Unknown batch type",t.type))},function(t){if(t)return n(t);n()})},i.prototype.isOpen=function(){return!0},t.exports=i},function(t,e){t.exports=n(39)},function(t,e){t.exports=n(40)},function(t,e,n){var r=n(2),o=n(49).AbstractLevelDOWN,i=n(3),s=n(50),a=n(51);function c(t){this.location=t,o.call(this,t)}r.inherits(c,o),c.prototype._open=function(t,e){e(null,this)},c.prototype._put=function(t,e,n,r){s.writeFile(a.join(this.location,t),e,"utf8",r)},c.prototype._get=function(t,e,n){s.readFile(a.join(this.location,t),"utf8",function(t,e){if(t)return n(new Error("NotFound"));n(null,e)})},c.prototype._del=function(t,e,n){s.unlink(a.join(this.location,t),function(t){if(t)return t.message.indexOf("ENOENT")>=0?n():n(t);n()})},c.prototype._batch=function(t,e,n){var r=this;i.each(t,function(t,n){"put"===t.type?r.put(t.key,t.value,e,n):"del"===t.type?r.del(t.key,e,n):n(new Error("Unknown batch type",t.type))},function(t){if(t)return n(t);n()})},t.exports=function(t){return new c(t)}},function(t,e){t.exports=n(41)},function(t,e){t.exports=n(42)},function(t,e){t.exports=n(43)},function(t,e){t.exports=n(44)},function(t,e,n){var r=n(21),o=n(3),i=n(10);t.exports={encode:function(t,e){var n=t.toJSON(!0);o.map(t.transactions,function(t,e){r.encode(t,e)},function(t,r){if(t)return e(t);n.transactions=r,e(null,n)})},decode:function(t,e){var n=t.transactions;t.transactions=[];var s=new i(t);o.eachSeries(n,function(t,e){r.decode(t,function(t,n){if(t)return e(t);s.transactions.push(n),e()})},function(t){if(t)return e(t);e(null,s)})}}},function(t,e,n){var r=n(1),o=n(0);t.exports={encode:function(t,e){e(null,o.hex(t))},decode:function(t,e){e(null,r.toBuffer(t))}}},function(t,e,n){var r=n(11),o=n(3);function i(t){this.database=t}i.prototype.encode=function(t,e){e(null,t=t.map(function(t){return t.toJSON()}))},i.prototype.decode=function(t,e){var n=this;if(0===t.length)return e(null,[]);this.database.blockHashes.get(t[0].blockHash,function(i,s){if(i)return e(i);n.database.blocks.get(s,function(n,i){if(n)return e(n);o.map(t,function(t,e){e(null,new r({block:i,logIndex:t.logIndex,transactionIndex:t.transactionIndex,transactionHash:t.transactionHash,address:t.address,data:t.data,topics:t.topics,type:t.type}))},function(t,n){if(t)return e(t);e(null,n)})})})},t.exports=i},function(t,e,n){var r=n(12),o=n(3);function i(t){this.database=t}i.prototype.encode=function(t,e){e(null,t.toJSON())},i.prototype.decode=function(t,e){var n=this;this.database.transactions.get(t.transactionHash,function(i,s){if(i)return e(i);n.database.blockHashes.get(t.blockHash,function(i,a){if(i)return e(i);o.parallel({block:n.database.blocks.get.bind(n.database.blocks,a),logs:n.database.blockLogs.get.bind(n.database.blockLogs,a)},function(n,o){if(n)return e(n);e(null,new r(s,o.block,o.logs,t.gasUsed,t.cumulativeGasUsed,t.contractAddress,t.status,t.logsBloom))})})})},t.exports=i},function(t,e){t.exports=n(46)},function(t,e,n){var r=n(18),o=n(7),i=n(10),s=n(11),a=n(12),c=n(1),u=n(59),l=n(14),h=n(0),f=n(3),p=n(15),d=n(68);function g(t){if(this.options=t||{},null==t.fork)throw new Error("ForkedBlockchain must be passed a fork parameter.");if(this.fork=t.fork,this.forkBlockNumber=t.forkBlockNumber,this.forkVersion=null,"string"==typeof this.fork){if(this.fork.indexOf("@")>=0){var e=this.fork.split("@");this.fork=e[0],this.forkBlockNumber=parseInt(e[1])}this.fork=new l.providers.HttpProvider(this.fork)}this.time=t.time,this.storageTrieCache={},r.call(this,t),this.web3=new l(this.fork)}(0,n(2).inherits)(g,r),g.prototype.initialize=function(t,e){var n=this;this.web3.eth.net.getId(function(o,i){if(o)return e(o);n.forkVersion=i,r.prototype.initialize.call(n,t,function(t){if(t)return e(t);n.vm.stateManager._lookupStorageTrie=n.lookupStorageTrie.bind(n),n.vm.stateManager.cache._lookupAccount=n.getAccount.bind(n),n.vm.stateManager.getContractCode=n.getCode.bind(n),n.vm.stateManager.putContractCode=n.putCode.bind(n),e()})})},g.prototype.createStateTrie=function(t,e){return new u(t,e,{fork:this.fork,forkBlockNumber:this.forkBlockNumber,blockchain:this})},g.prototype.createGenesisBlock=function(t){var e=this,n=this.forkBlockNumber||"latest";e.web3.eth.getBlock(n,function(r,o){if(r)return t(r);!e.time&&e.forkBlockNumber&&(e.time=e.options.time=new Date(1e3*h.number(o.timestamp)),e.setTime(e.time)),n=h.hex(o.number),e.forkBlockNumber=e.options.forkBlockNumber=n,e.stateTrie.forkBlockNumber=n,e.createBlock(function(e,n){if(e)return t(e);n.header.number=c.toBuffer(h.number(o.number)+1),n.header.parentHash=c.toBuffer(o.hash),t(null,n)})})},g.prototype.createForkedStorageTrie=function(t){t=h.hex(t);var e=new u(this.data.trie_db,null,{address:t,stateTrie:this.stateTrie,blockchain:this,fork:this.fork,forkBlockNumber:this.forkBlockNumber});return this.storageTrieCache[t]=e,e},g.prototype.lookupStorageTrie=function(t,e){if(t=h.hex(t),null!=this.storageTrieCache[t])return e(null,this.storageTrieCache[t]);e(null,this.createForkedStorageTrie(t))},g.prototype.isFallbackBlock=function(t,e){var n=this;n.getEffectiveBlockNumber(t,function(t,r){if(t)return e(t);e(null,r<=h.number(n.forkBlockNumber))})},g.prototype.isBlockHash=function(t){return"string"==typeof t&&0===t.indexOf("0x")&&t.length>42},g.prototype.isFallbackBlockHash=function(t,e){if(!this.isBlockHash(t))return e(null,!1);this.data.blockHashes.get(t,function(t,n){if(t)return t.notFound?e(null,!0):e(t);e(null,!1)})},g.prototype.getFallbackBlock=function(t,e){"string"==typeof t&&t.length<66&&(t=this.web3.utils.toBN(t)),this.web3.eth.getBlock(t,!0,function(t,n){if(t)return e(t);if(null==n)return e();var r=new i;r.header.parentHash=c.toBuffer(n.parentHash),r.header.uncleHash=c.toBuffer(n.sha3Uncles),r.header.coinbase=c.toBuffer(n.miner),r.header.stateRoot=c.toBuffer(n.stateRoot),r.header.transactionTrie=c.toBuffer(n.transactionsRoot),r.header.receiptTrie=c.toBuffer(n.receiptsRoot),r.header.bloom=c.toBuffer(n.logsBloom),r.header.difficulty=c.toBuffer("0x"+n.totalDifficulty.toString(16)),r.header.number=c.toBuffer(n.number),r.header.gasLimit=c.toBuffer(n.gasLimit),r.header.gasUsed=c.toBuffer(n.gasUsed),r.header.timestamp=c.toBuffer(n.timestamp),r.header.extraData=c.toBuffer(n.extraData),(n.transactions||[]).forEach(function(t,e){r.transactions.push(p.fromJSON(t))}),r.hash=function(){return c.toBuffer(n.hash)},e(null,r)})},g.prototype.getBlock=function(t,e){var n=this;this.isFallbackBlockHash(t,function(o,i){return o?e(o):i?n.getFallbackBlock(t,e):void n.isFallbackBlock(t,function(o,i){return o?e(o):i?n.getFallbackBlock(t,e):void function(t,e){n.isBlockHash(t)?e(null,t):n.getRelativeBlockNumber(t,e)}(t,function(t,o){if(t)return e(t);r.prototype.getBlock.call(n,o,e)})})})},g.prototype.getStorage=function(t,e,n,r){this.lookupStorageTrie(t,function(t,n){if(t)return r(t);n.get(e,r)})},g.prototype.getCode=function(t,e,n){var o=this;"function"==typeof e&&(n=e,e="latest"),e||(e="latest"),this.getEffectiveBlockNumber(e,function(i,s){if(i)return n(i);e=s,o.stateTrie.keyExists(t,function(i,s){if(i)return n(i);s&&e>h.number(o.forkBlockNumber)?r.prototype.getCode.call(o,t,e,n):(e>h.number(o.forkBlockNumber)&&(e="latest"),o.fetchCodeFromFallback(t,e,function(t,e){e&&(e=c.toBuffer(e)),n(t,e)}))})})},g.prototype.putCode=function(t,e,n){var r=this;r.vm.stateManager.cache.flush(()=>{t=c.toBuffer(t),this.stateTrie.get(t,function(i,s){if(i)return n(i);var a=new o(s);a.setCode(r.stateTrie,e,function(e,o){if(e)return n(e);r.stateTrie.put(t,a.serialize(),function(e){if(e)return n(e);r.vm.stateManager.putAccount(t,a,n)})})})})},g.prototype.getAccount=function(t,e,n){var o=this;"function"==typeof e&&(n=e,e="latest"),this.getEffectiveBlockNumber(e,function(i,s){if(i)return n(i);e=s,o.stateTrie.keyExists(t,function(i,s){if(i)return n(i);s&&e>h.number(o.forkBlockNumber)?r.prototype.getAccount.call(o,t,e,function(t,e){if(t)return n(t);n(null,e)}):o.fetchAccountFromFallback(t,e,n)})})},g.prototype.getTransaction=function(t,e){var n=this;r.prototype.getTransaction.call(this,t,function(r,o){return r?e(r):null!=o?e(null,o):void n.web3.eth.getTransaction(t,function(t,n){if(t)return e(t);n&&(n=p.fromJSON(n)),e(null,n)})})},g.prototype.getTransactionReceipt=function(t,e){var n=this;r.prototype.getTransactionReceipt.call(this,t,function(r,o){return r?e(r):o?e(null,o):void n.web3.eth.getTransactionReceipt(t,function(r,o){return r?e(r):o?void f.parallel({tx:n.getTransaction.bind(n,t),block:n.getBlock.bind(n,o.blockNumber)},function(t,n){if(t)return e(t);var r=o.logs.map(function(t){return new s(t)}),i=new a(n.tx,n.block,r,o.gasUsed,o.cumulativeGasUsed,o.contractAddress,o.status,h.hex(o.logsBloom));e(null,i)}):e()})})},g.prototype.fetchAccountFromFallback=function(t,e,n){var r=this;t=h.hex(t),f.parallel({code:this.fetchCodeFromFallback.bind(this,t,e),balance:this.fetchBalanceFromFallback.bind(this,t,e),nonce:this.fetchNonceFromFallback.bind(this,t,e)},function(t,e){if(t)return n(t);var i=e.code,s=e.balance,a=e.nonce,u=new o({nonce:a,balance:s});u.exists="0x"!==i||"0x0"!==s||"0x0"!==a,u.setCode(r.stateTrie,c.toBuffer(i),function(t){if(t)return n(t);n(null,u)})})},g.prototype.fetchCodeFromFallback=function(t,e,n){var r=this;t=h.hex(t),"function"==typeof e&&(n=e,e=this.forkBlockNumber),this.getSafeFallbackBlockNumber(e,function(e,o){if(e)return n(e);r.web3.eth.getCode(t,o,function(t,e){if(t)return n(t);e="0x"+c.toBuffer(e).toString("hex"),n(null,e)})})},g.prototype.fetchBalanceFromFallback=function(t,e,n){var r=this;t=h.hex(t),"function"==typeof e&&(n=e,e=this.forkBlockNumber),this.getSafeFallbackBlockNumber(e,function(e,o){if(e)return n(e);r.web3.eth.getBalance(t,o,function(t,e){if(t)return n(t);e="0x"+new d(e).toString(16),n(null,e)})})},g.prototype.fetchNonceFromFallback=function(t,e,n){var r=this;t=h.hex(t),"function"==typeof e&&(n=e,e=this.forkBlockNumber),this.getSafeFallbackBlockNumber(e,function(e,o){if(e)return n(e);r.web3.eth.getTransactionCount(t,o,function(t,e){if(t)return n(t);e="0x"+r.web3.utils.toBN(e).toString(16),n(null,e)})})},g.prototype.getHeight=function(t){this.latestBlock(function(e,n){if(e)return t(e);t(null,h.number(n.header.number))})},g.prototype.getRelativeBlockNumber=function(t,e){var n=this;this.getEffectiveBlockNumber(t,function(t,r){if(t)return e(t);e(null,r-h.number(n.forkBlockNumber)-1)})},g.prototype.getSafeFallbackBlockNumber=function(t,e){var n=h.number(this.forkBlockNumber);if(null==t)return e(null,n);this.getEffectiveBlockNumber(t,function(t,r){if(t)return e(t);r>n&&(r=n),e(null,r)})},g.prototype.getBlockLogs=function(t,e){var n=this;this.getEffectiveBlockNumber(t,function(o,i){if(o)return e(o);n.getRelativeBlockNumber(i,function(o,i){if(o)return e(o);i<0?n.getBlock(t,function(r,o){if(r)return e(r);n.web3.currentProvider.send({jsonrpc:"2.0",method:"eth_getLogs",params:[{fromBlock:h.hex(t),toBlock:h.hex(t)}],id:(new Date).getTime()},function(t,n){if(t)return e(t);var r=n.result.map(function(t){return t.block=o,new s(t)});e(null,r)})}):r.prototype.getBlockLogs.call(n,i,e)})})},g.prototype._checkpointTrie=function(){var t=this;r.prototype._checkpointTrie.call(this),Object.keys(this.storageTrieCache).forEach(function(e){t.storageTrieCache[e].customCheckpoint()})},g.prototype._revertTrie=function(){var t=this;r.prototype._revertTrie.call(this),Object.keys(this.storageTrieCache).forEach(function(e){var n=t.storageTrieCache[e];0===n.checkpoints.length?delete t.storageTrieCache[e]:n.customRevert()})},t.exports=g},function(t,e,n){var r=n(19),o=n(1),i=n(2).inherits,s=n(14),a=n(0);function c(t,e,n){r.call(this,t,e),this.address=n.address,this.fork=n.fork,this.forkBlockNumber=n.forkBlockNumber,this.blockchain=n.blockchain,this.web3=new s,this.web3.setProvider(this.fork),this.checkpoints=[]}i(c,r),c.prototype.keyExists=function(t,e){t=o.toBuffer(t),this.findPath(t,function(t,n,r,o){var i=!1;n&&0===r.length&&(i=!0),e(t,i)})},c.prototype.get=function(t,e,n){var i=this;"function"==typeof e&&(n=e,e=i.forkBlockNumber),e=a.rpcQuantityHexString(e),t=o.toBuffer(t),this.keyExists(t,function(s,c){if(s)return n(s);c?r.prototype.get.call(i,t,function(t,e){n(t,e)}):null==i.address?i.blockchain.fetchAccountFromFallback(t,e,function(t,e){if(t)return n(t);n(null,e.serialize())}):i.web3.eth.getStorageAt(a.hex(i.address),a.hex(t),e,function(t,e){if(t)return n(t);e=o.toBuffer(e),e=o.rlp.encode(e),n(null,e)})})},c.prototype.customCheckpoint=function(){this.checkpoints.push(this.root)},c.prototype.customRevert=function(){this.root=this.checkpoints.pop()},t.exports=c},function(t){t.exports={_args:[["web3@1.0.0-beta.35","C:\\Users\\David\\Desktop\\Code\\ganache-core"]],_development:!0,_from:"web3@1.0.0-beta.35",_id:"web3@1.0.0-beta.35",_inBundle:!1,_integrity:"sha512-xwDmUhvTcHQvvNnOPcPZZgCxKUsI2e+GbHy7JkTK3/Rmnutazy8x7fsAXT9myw7V1qpi3GgLoZ3fkglSUbg1Mg==",_location:"/web3",_optional:!0,_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"web3@1.0.0-beta.35",name:"web3",escapedName:"web3",rawSpec:"1.0.0-beta.35",saveSpec:null,fetchSpec:"1.0.0-beta.35"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/web3/-/web3-1.0.0-beta.35.tgz",_spec:"1.0.0-beta.35",_where:"C:\\Users\\David\\Desktop\\Code\\ganache-core",author:{name:"ethereum.org"},authors:[{name:"Fabian Vogelsteller",email:"fabian@ethereum.org",homepage:"http://frozeman.de"},{name:"Marek Kotewicz",email:"marek@parity.io",url:"https://github.com/debris"},{name:"Marian Oancea",url:"https://github.com/cubedro"},{name:"Gav Wood",email:"g@parity.io",homepage:"http://gavwood.com"},{name:"Jeffery Wilcke",email:"jeffrey.wilcke@ethereum.org",url:"https://github.com/obscuren"}],bugs:{url:"https://github.com/ethereum/web3.js/issues"},dependencies:{"web3-bzz":"1.0.0-beta.35","web3-core":"1.0.0-beta.35","web3-eth":"1.0.0-beta.35","web3-eth-personal":"1.0.0-beta.35","web3-net":"1.0.0-beta.35","web3-shh":"1.0.0-beta.35","web3-utils":"1.0.0-beta.35"},description:"Ethereum JavaScript API",keywords:["Ethereum","JavaScript","API"],license:"LGPL-3.0",main:"src/index.js",name:"web3",namespace:"ethereum",repository:{type:"git",url:"https://github.com/ethereum/web3.js/tree/master/packages/web3"},types:"index.d.ts",version:"1.0.0-beta.35"}},function(t,e){t.exports=n(47)},function(t,e){t.exports=n(48)},function(t,e){t.exports=n(49)},function(t,e){t.exports=n(50)},function(t,e){t.exports=n(51)},function(t,e){t.exports=n(52)},function(t,e){t.exports=n(53)},function(t,e){t.exports=n(54)},function(t,e){t.exports=n(55)},function(t,e){t.exports={randomBytes:function(t,e){for(var n=[],r=0;r<t;r++)n.push(255*e());return o.from(n)},randomAlphaNumericString:function(t,e){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let r="";for(var o=0;o<t;o++)r+=n.charAt(Math.floor((e||Math.random)()*n.length));return r}}},function(t,e,n){function r(t){Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=t}(0,n(2).inherits)(r,Error),t.exports=r},function(t){t.exports={name:"ganache-core",version:"2.2.1",main:"./index.js",engines:{node:">=8.9.0"},directories:{lib:"./lib"},prettier:{printWidth:120,arrowParens:"always"},scripts:{_mocha:"mocha --check-leaks --recursive --globals _scratch,sanitizedData",_lint:"eslint --ignore-path .gitignore .",build:"webpack-cli --config ./webpack/node/core.webpack.config.js","build-web":"webpack-cli --config ./webpack/web-experimental/core.webpack.config.js",format:'prettier --write "{lib,perf,test}/**/*.js" && eslint --fix --ignore-path .gitignore .',prepublishOnly:"npm run test && npm run build && npm run test-build",test:"npm run _lint && npm run _mocha","test-build":"cross-env TEST_BUILD=node npm run _mocha","test-web-experimental":"cross-env TEST_BUILD=web-experimental npm run _mocha"},dependencies:{"abstract-leveldown":"3.0.0",async:"2.6.1",bip39:"2.5.0","bn.js":"4.11.8",cachedown:"1.0.0",clone:"2.1.2",debug:"3.1.0","encoding-down":"5.0.4","eth-sig-util":"2.0.2","ethereumjs-abi":"0.6.5","ethereumjs-account":"2.0.5","ethereumjs-block":"1.2.2","ethereumjs-tx":"1.3.4","ethereumjs-util":"5.2.0","ethereumjs-vm":"2.4.0",heap:"0.2.6","intercept-require":"^1.1.0","level-sublevel":"6.6.4",levelup:"3.1.1",lodash:"4.17.10","merkle-patricia-tree":"2.3.1",seedrandom:"2.4.4",tmp:"0.0.33","web3-provider-engine":"^14.0.6",websocket:"1.0.26"},devDependencies:{"assert-match":"^1.1.1",eslint:"5.7.0","eslint-config-standard":"12.0.0","eslint-plugin-import":"2.14.0","eslint-plugin-node":"7.0.1","eslint-plugin-promise":"4.0.1","eslint-plugin-standard":"4.0.0",memdown:"^1.3.1",mocha:"5.2.0",prettier:"^1.14.3",browserfs:"1.4.3","cross-env":"5.2.0","ethereumjs-wallet":"0.6.2",pify:"4.0.0",portfinder:"^1.0.18",request:"^2.88.0",solc:"0.4.24","source-map-support":"^0.5.9",temp:"0.8.3",web3:"1.0.0-beta.35",webpack:"4.17.1","webpack-bundle-size-analyzer":"2.7.0","webpack-cli":"3.1.0"},optionalDependencies:{"ethereumjs-wallet":"0.6.2",web3:"1.0.0-beta.35"},repository:{type:"git",url:"https://github.com/trufflesuite/ganache-core"},license:"MIT"}},function(t,e,n){const r=n(13);var o=n(22);function i(t){if(t=t||{},r.apply(this),!t.blockchain)throw new Error("RpcBlockTracker - no blockchain specified.");if(!t.blockchain.on)throw new Error("RpcBlockTracker - blockchain is not an EventEmitter.");this._blockchain=t.blockchain,this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.getTrackingBlock=this.getTrackingBlock.bind(this),this.awaitCurrentBlock=this.awaitCurrentBlock.bind(this),this._setCurrentBlock=this._setCurrentBlock.bind(this)}i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.getTrackingBlock=function(){return this._currentBlock},i.prototype.getCurrentBlock=function(){return this._currentBlock},i.prototype.awaitCurrentBlock=function(){const t=this;return this._currentBlock?this._currentBlock:new Promise(t=>this.once("block",t)).then(()=>t._currentBlock)},i.prototype.start=function(t={}){return this._blockchain.on("block",this._setCurrentBlock),Promise.resolve()},i.prototype.stop=function(){this._isRunning=!1,this._blockchain.removeListener("block",this._setCurrentBlock)},i.prototype._setCurrentBlock=function(t){let e=o.toJSON(t,!0);if(this._currentBlock&&this._currentBlock.hash===e.hash)return;const n=this._currentBlock;this._currentBlock=e,this.emit("latest",e),this.emit("sync",{block:e,oldBlock:n}),this.emit("block",e)},t.exports=i},function(t,e,n){n(6);var r=n(16),o=n(75),i=n(77),s=n(5);t.exports={create:function(t){var e=(t=c(t||{})).logger,n=new r(t),s=i(n,e);s.keepAliveTimeout=t.keepAliveTimeout;let a=0;const u={};s.on("connection",t=>{let e=a++;u[e]=t,t.on("close",()=>delete u[e])});var l=s.listen;s.listen=function(){var t=Array.prototype.slice.call(arguments),e=function(){};t.length>0&&"function"==typeof t[t.length-1]&&(e=t.pop()),t.push(function(t){if(t)return e(t);s.provider.manager.waitForInitialization(e)}),l.apply(s,t)},s.provider=n,t.ws&&o(s,n,e);var h=s.close;return s.close=function(t){var e=Array.prototype.slice.call(arguments);h.apply(s,e),s.provider.close(function(e){if(e)return t(e);Object.keys(u).forEach(t=>{try{u[t].destroy()}catch(t){}})})},s}};const a={logger:{log:function(){}},ws:!0,keepAliveTimeout:5e3};var c=function(t){return s.merge({},a,t)}},function(t,e,n){var r=n(76).server;function o(t,e){const n=this;n.provider=t,n.logger=e,n.connectionsBySubscriptionId={},n.connections={},n.connectionCounter=0,n._updateSubscriptions=n._updateSubscriptions.bind(n),n.manageConnection=n.manageConnection.bind(n),n._logPayload=n._logPayload.bind(n),n._handleRequest=n._handleRequest.bind(n),t.on("data",function(t,e){t||n._updateSubscriptions(e)})}t.exports=function(t,e,n){var i=new o(e,n),s=new r({httpServer:t,autoAcceptConnections:!0});return s.on("connect",i.manageConnection),s},o.prototype.manageConnection=function(t){const e=this;t.id=++e.connectionCounter,e.connections[t.id]={connection:t,subscriptions:{}},t.on("message",function(n){try{var r=JSON.parse(n.utf8Data)}catch(e){t.reject(400,"Bad Request")}e._logPayload(r),e._handleRequest(t,r)}),t.on("close",function(){Object.keys(e.connections[t.id].subscriptions).forEach(t=>{e.provider.send({jsonrpc:"2.0",method:"eth_unsubscribe",params:[t],id:(new Date).getTime()},function(n,r){n||delete e.connectionsBySubscriptionId[t]})}),delete e.connections[t.id]})},o.prototype._handleRequest=function(t,e){const n=this;switch(e.method){case"eth_subscribe":n.provider.send(e,function(e,r){!e&&r.result&&(n.connections[t.id].subscriptions[r.result]=!0,n.connectionsBySubscriptionId[r.result]=n.connections[t.id]),t.send(JSON.stringify(r))});break;case"eth_unsubscribe":n.provider.send(e,function(r,o){r||o.error?t&&t.send&&t.send(JSON.stringify(o)):(delete n.connections[t.id].subscriptions[e.params[0]],delete n.connectionsBySubscriptionId[e.params[0]],t.send(JSON.stringify(o)))});break;default:n.provider.send(e,function(e,n){t.send(JSON.stringify(n))})}},o.prototype._logPayload=function(t){const e=this;if(t instanceof Array)for(var n=0;n<t.length;n++){var r=t[n];e.logger.log(r.method)}else e.logger.log(t.method)},o.prototype._updateSubscriptions=function(t){this.connectionsBySubscriptionId[t.params.subscription].connection.send(JSON.stringify(t))}},function(t,e){t.exports=n(57)},function(t,e,n){var r=n(78);t.exports=function(t,e){var n=r.createServer(function(n,r){var i=n.method,s=[];n.on("data",function(t){s.push(t)}).on("end",function(){s=o.concat(s).toString();var n={"Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, User-Agent","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"};switch(i){case"OPTIONS":n["Content-Type"]="text/plain",r.writeHead(200,n),r.end("");break;case"POST":var a;try{a=JSON.parse(s)}catch(t){return n["Content-Type"]="text/plain",r.writeHead(400,n),void r.end("400 Bad Request")}if(a instanceof Array)for(var c=0;c<a.length;c++){var u=a[c];e.log(u.method)}else e.log(a.method);t.send(a,function(t,e){n["Content-Type"]="application/json",r.writeHead(200,n),r.end(JSON.stringify(e))});break;default:r.writeHead(400,{"Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, User-Agent","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*","Content-Type":"text/plain"}),r.end("400 Bad Request")}})});return n.ganacheProvider=t,n}},function(t,e){t.exports=n(58)}])}).call(this,n(13),n(12).setImmediate,n(6).Buffer)}])});
//# sourceMappingURL=ganache.core.web-experimental.js.map